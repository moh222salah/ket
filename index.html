<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - ØªØªØ¨Ø¹ Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù…Ø²Ø§Ø±Ø¹ ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©">
    <meta name="keywords" content="Ù…Ø§Ù†Ø¬Ùˆ ÙƒÙŠØª, ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹, Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ, Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ù…ØµØ±ÙŠØ©">
    <meta name="author" content="Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª">
    
    <title>ğŸ¥­ Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… | Ù…ØµØ±</title>
    <meta name="theme-color" content="#2b9348">
    
    <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2909/2909768.png" type="image/png">
    
    <!-- Ø®Ø·ÙˆØ· Google - Cairo -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- Ù…ÙƒØªØ¨Ø© Font Awesome Ù„Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Ù…ÙƒØªØ¨Ø© Leaflet Ù„Ù„Ø®Ø±Ø§Ø¦Ø· Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Tailwind CSS Ø¹Ø¨Ø± CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Ù…ÙƒØªØ¨Ø© Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    




    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #001ea1 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #060e74 0%, #ffffff 100%);
            --success-gradient: linear-gradient(135deg, #ffffff 0%, #101687 100%);
            --warning-gradient: linear-gradient(135deg, #ffffff 0%, #000000 100%);
            --danger-gradient: linear-gradient(135deg, #ffffff 0%, #032f85 100%);
            --search-gradient: linear-gradient(135deg, #ffffff 0%, #18067e 100%);
            --area-gradient: linear-gradient(135deg, #ffffff 0%, #000341 100%);
            --dark-bg: #0a0e1a;
            --darker-bg: #070b15;
            --card-bg: rgba(255, 255, 255, 0.08);
            --glass-border: rgba(255, 255, 255, 0.15);
            --text-primary: #ffffff;
            --text-secondary: #ffffff;
            --text-accent: #f9f9f9;
            --shadow-glow: 0 25px 50px rgba(0, 0, 0, 0.4);
            --input-bg: rgba(255, 255, 255, 0.1);
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-blue: #00d4ff;
            --accent-green: #00ff88;
            --accent-orange: #ff9800;
            --accent-red: #ff6b6b;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --shadow-light: rgba(0, 0, 0, 0.1);
            --shadow-medium: rgba(0, 0, 0, 0.2);
            --shadow-heavy: rgba(0, 0, 0, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            line-height: 1.6;
        }
        
        /* Ø®Ù„ÙÙŠØ© Ù…ØªØ­Ø±ÙƒØ© Ù…ØªÙ‚Ø¯Ù…Ø© */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 15% 25%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 85% 75%, rgba(118, 75, 162, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(0, 242, 254, 0.05) 0%, transparent 70%),
                linear-gradient(135deg, var(--dark-bg) 0%, var(--darker-bg) 100%);
            animation: backgroundFlow 20s ease-in-out infinite;
            z-index: -1;
        }
        
        @keyframes backgroundFlow {
            0%, 100% { 
                background-position: 0% 0%, 100% 100%, 50% 50%;
                filter: hue-rotate(0deg);
            }
            50% { 
                background-position: 100% 100%, 0% 0%, 25% 75%;
                filter: hue-rotate(30deg);
            }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        /* Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© */
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            padding: 40px 0;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -30%;
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 200px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.3;
            z-index: -1;
        }
        
        .main-title {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 900;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            animation: title-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes title-glow {
            from { filter: drop-shadow(0 0 10px rgba(0, 212, 255, 0.5)); }
            to { filter: drop-shadow(0 0 20px rgba(0, 255, 136, 0.8)); }
        }
        
        .subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 300;
            max-width: 600px;
            margin: 0 auto;
        }
        
        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 30px var(--shadow-light);
            margin-bottom: 25px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px var(--shadow-medium);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .card:hover::before {
            left: 100%;
        }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
        .btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
            text-decoration: none;
            font-family: inherit;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-success {
            background: linear-gradient(45deg, var(--success-color), #66bb6a);
        }
        
        .btn-warning {
            background: linear-gradient(45deg, var(--warning-color), #ffb74d);
        }
        
        .btn-danger {
            background: linear-gradient(45deg, var(--danger-color), #e57373);
        }
        
        /* Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
        .form-input, .form-select {
            padding: 12px 20px;
            border: 2px solid var(--glass-border);
            border-radius: 15px;
            font-size: 1rem;
            width: 100%;
            outline: none;
            transition: all 0.3s ease;
            background: var(--input-bg);
            color: var(--text-primary);
            font-family: inherit;
            backdrop-filter: blur(10px);
        }
        
        .form-input:focus, .form-select:focus {
            border-color: var(--accent-blue);
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.2);
        }
        
        .form-input::placeholder {
            color: var(--text-secondary);
        }
        
        /* Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ù…Ø±Ù† */
        .flex {
            display: flex;
        }
        
        .flex-center {
            align-items: center;
            justify-content: center;
        }
        
        .flex-between {
            justify-content: space-between;
        }
        
        .flex-wrap {
            flex-wrap: wrap;
        }
        
        .gap-4 {
            gap: 1rem;
        }
        
        .gap-6 {
            gap: 1.5rem;
        }
        
        /* Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ø±Ù†Ø© */
        .grid {
            display: grid;
        }
        
        .grid-auto {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
        
        .grid-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .grid-3 {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .grid-4 {
            grid-template-columns: repeat(4, 1fr);
        }
        
        /* Ø§Ù„Ù…Ø³Ø§ÙØ§Øª */
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        
        /* Ø§Ù„Ù†ØµÙˆØµ */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        
        /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† */
        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .text-success { color: var(--success-color); }
        .text-warning { color: var(--warning-color); }
        .text-danger { color: var(--danger-color); }
        .text-accent-blue { color: var(--accent-blue); }
        .text-accent-green { color: var(--accent-green); }
        .text-accent-orange { color: var(--accent-orange); }
        
        /* Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(0.8,0,1,1); }
            50% { transform: none; animation-timing-function: cubic-bezier(0,0,0.2,1); }
        }
        
        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: var(--accent-blue);
        }
        
        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 212, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-blue);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-left: 5px;
        }
        
        .bg-success { background-color: var(--success-color); }
        .bg-warning { background-color: var(--warning-color); }
        .bg-danger { background-color: var(--danger-color); }
        
        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .result-card {
            background: var(--card-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 30px;
            position: relative;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            cursor: pointer;
        }
        
        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.6s ease;
        }
        
        .result-card:hover::before {
            left: 100%;
        }
        
        .result-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-glow);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
            position: relative;
            z-index: 2;
        }
        
        .mango-info {
            flex: 1;
        }
        
        .mango-variety {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        
        .mango-scientific-name {
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-style: italic;
            margin-bottom: 10px;
        }
        
        .quality-badge {
            padding: 8px 16px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .quality-excellent {
            background: var(--success-gradient);
            color: white;
            animation: pulse-excellent 3s infinite;
        }
        
        .quality-good {
            background: var(--warning-gradient);
            color: white;
        }
        
        .quality-premium {
            background: var(--secondary-gradient);
            color: white;
            animation: pulse-premium 3s infinite;
        }
        
        @keyframes pulse-excellent {
            0%, 100% { box-shadow: 0 0 0 0 rgba(79, 172, 254, 0.7); }
            50% { box-shadow: 0 0 0 15px rgba(79, 172, 254, 0); }
        }
        
        @keyframes pulse-premium {
            0%, 100% { box-shadow: 0 0 0 0 rgba(240, 147, 251, 0.7); }
            50% { box-shadow: 0 0 0 15px rgba(240, 147, 251, 0); }
        }
        
        .card-content {
            position: relative;
            z-index: 2;
        }
        
        .location-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .location-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-accent);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .location-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .location-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        
        .location-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .location-value {
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1rem;
        }
        
        .area-highlight {
            color: var(--text-accent) !important;
            font-size: 1.2rem !important;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        
        .stat-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-accent);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .characteristics {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .characteristics-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 15px;
        }
        
        .characteristics-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .characteristic-tag {
            background: var(--primary-gradient);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        /* Loading Ùˆ Empty States */
        .loading-container {
            text-align: center;
            padding: 60px 20px;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid var(--text-accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }
        
        .empty-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--text-secondary);
        }
        
        /* Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .statistics-panel {
            background: var(--card-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .statistics-title {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 25px;
            color: var(--text-primary);
        }
        
        .statistics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .statistic-card {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            transition: all 0.3s ease;
        }
        
        .statistic-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
        }
        
        .statistic-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            background: var(--area-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .statistic-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-accent);
            margin-bottom: 8px;
        }
        
        .statistic-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ù„ */
        @media (max-width: 1200px) {
            .container { padding: 15px; }
            .grid-4 { grid-template-columns: repeat(3, 1fr); }
        }
        
        @media (max-width: 768px) {
            .container { padding: 10px; }
            .grid-4, .grid-3, .grid-2 { grid-template-columns: 1fr; }
            .main-title { font-size: 2rem; }
            .subtitle { font-size: 1rem; }
            .flex { flex-direction: column; }
            .btn { padding: 10px 20px; font-size: 0.9rem; }
            
            .location-details {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .results-header {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .sort-options {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
        
        @media (max-width: 480px) {
            .main-title { font-size: 1.8rem; }
            .card { padding: 15px; }
            .btn { padding: 8px 16px; }
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© */
        .ripple-effect {
            position: relative;
            overflow: hidden;
        }
        
        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
        }
        
        @keyframes ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        /* ØªØ®ØµÙŠØµØ§Øª Ø§Ù„Ø®Ø±ÙŠØ·Ø© */
        .leaflet-popup-content-wrapper {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            color: var(--text-primary);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
        }
        
        .leaflet-popup-tip {
            background: var(--card-bg);
        }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø§Ù„Ù…Ø®ØµØµ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--darker-bg);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
        
        /* Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« */
        .update-status, .update-indicator, .loading {
            position: fixed;
            bottom: 10px;
            left: 10px;
            z-index: 999;
            background: white;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .update-status .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: green;
            display: inline-block;
            margin-left: 5px;
        }
        
        .update-indicator {
            top: 10px;
            left: 10px;
            display: none;
        }
        
        .loading {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            text-align: center;
        }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… */
        .search-section {
            background: var(--card-bg);
            backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }
        
        .search-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg at 50% 50%, transparent, rgba(102, 126, 234, 0.1), transparent);
            animation: rotate 15s linear infinite;
            opacity: 0.7;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .search-content {
            position: relative;
            z-index: 2;
        }
        
        .search-title {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            background: var(--search-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .search-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .form-group {
            position: relative;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .search-input-container {
            position: relative;
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-accent);
            font-size: 1.2rem;
            pointer-events: none;
        }
        
        .search-btn {
            background: var(--search-gradient);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .search-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .search-btn:hover::before {
            left: 100%;
        }
        
        .search-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }
        
        .advanced-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .filter-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .filter-group:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .range-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .range-input {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .range-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--text-accent);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 242, 254, 0.5);
        }
        
        .range-value {
            min-width: 60px;
            text-align: center;
            font-weight: 600;
            color: var(--text-accent);
        }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
        .results-section {
            margin: 40px 0;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .results-title {
            font-size: 2rem;
            font-weight: 700;
            background: var(--area-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .results-count {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            padding: 10px 20px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .sort-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .sort-btn {
            background: var(--input-bg);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .sort-btn.active,
        .sort-btn:hover {
            background: var(--success-gradient);
            color: white;
            transform: translateY(-2px);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
        }
    </style>




  <style>
    /* âœ… Ù…ÙˆØ¨Ø§ÙŠÙ„ */
    @media (max-width: 768px) {
      .results-header {
        flex-direction: column;
        text-align: center;
      }
      .btn { font-size: 13px; padding: 8px 12px; }
    }
  </style>
  
</head>

<body>
    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="container">
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <header class="header text-center mb-8">
            <h1 class="main-title mb-4">
                <i class="fas fa-seedling text-warning"></i>
                Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
            </h1>
            <p class="subtitle mb-4">
                <i class="fas fa-map-marked-alt text-accent-blue"></i>
               â€¢  Ø·Ø±ÙŠÙ‚ Ù…ØµØ± Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ â€¢ 
            </p>
        </header>
        
        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <section class="status-overview mb-8">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 text-center">
                    <i class="fas fa-chart-pie text-accent-green"></i>
                    Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                </h2>
                <div class="grid grid-auto gap-6">
                    <div class="stat-card text-center p-4">
                        <div class="stat-icon mb-4">
                            <i class="fas fa-map-marker-alt text-accent-blue text-3xl"></i>
                        </div>
                        <div class="stat-value text-3xl font-bold text-accent-green" id="totalRegions">847</div>
                        <div class="stat-label text-secondary">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ù†ØªØ¬Ø©</div>
                    </div>
                    <div class="stat-card text-center p-4">
                        <div class="stat-icon mb-4">
                            <i class="fas fa-check-circle text-success text-3xl"></i>
                        </div>
                        <div class="stat-value text-3xl font-bold text-success" id="availableCount">568</div>
                        <div class="stat-label text-secondary">Ù…ØªÙˆÙØ± Ù„Ù„Ø­ØµØ§Ø¯</div>
                    </div>
                    <div class="stat-card text-center p-4">
                        <div class="stat-icon mb-4">
                            <i class="fas fa-tractor text-warning text-3xl"></i>
                        </div>
                        <div class="stat-value text-3xl font-bold text-warning" id="totalFarms">2,847</div>
                        <div class="stat-label text-secondary">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</div>
                    </div>
                    <div class="stat-card text-center p-4">
                        <div class="stat-icon mb-4">
                            <i class="fas fa-weight-hanging text-accent-blue text-3xl"></i>
                        </div>
                        <div class="stat-value text-3xl font-bold text-accent-blue" id="totalQuantity">680,400</div>
                        <div class="stat-label text-secondary">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (Ø·Ù†)</div>
                    </div>
                    <div class="stat-card text-center p-4">
                        <div class="stat-icon mb-4">
                            <i class="fas fa-coins text-warning text-3xl"></i>
                        </div>
                        <div class="stat-value text-3xl font-bold text-warning" id="averagePrice">47.50</div>
                        <div class="stat-label text-secondary">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø± (Ø¬Ù†ÙŠÙ‡/ÙƒÙŠÙ„Ùˆ)</div>
                    </div>
                    <div class="stat-card text-center p-4">
                        <div class="stat-icon mb-4">
                            <i class="fas fa-clock text-accent-green text-3xl"></i>
                        </div>
                        <div class="stat-value text-3xl font-bold text-accent-green" id="lastUpdate">Ø§Ù„Ø¢Ù†</div>
                        <div class="stat-label text-secondary">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</div>
                    </div>
                </div>
            </div>
        </section>

<!-- ğŸ“Š ØªÙˆÙ‚Ø¹ Ø³Ø¹Ø± Ù…Ø§Ù†Ø¬Ùˆ ÙƒÙŠØª (Ù…Ù†Ø§Ø·Ù‚ Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ) -->
<section class="price-forecast-regional mb-12">
  <div class="card glass-card p-8 text-center rounded-2xl shadow-2xl border border-white/20">
    
    <h3 class="text-3xl font-extrabold mb-8 flex items-center justify-center gap-3 text-white drop-shadow">
      <i class="fas fa-globe text-accent-green text-3xl"></i>
      Ù…ØªÙˆØ³Ø· Ø³Ø¹Ø± Ù…Ø§Ù†Ø¬Ùˆ ÙƒÙŠØª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¯Ù… â€“ Ø·Ø±ÙŠÙ‚ Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
    </h3>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <!-- Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø± -->
      <div class="glass-box p-6 rounded-2xl shadow-inner border border-white/10">
        <p class="text-lg font-semibold mb-3 flex items-center justify-center gap-2 text-white">
          <i class="fas fa-hourglass-half text-accent-blue text-xl"></i>
          Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ
        </p>
        <span id="avgWeeklyRegionalPrice" class="text-3xl font-extrabold text-accent-blue drop-shadow">--</span> <span class="text-white">Ø¬</span>
      </div>

      <!-- Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù‚Ø§Ø¯Ù… -->
      <div class="glass-box p-6 rounded-2xl shadow-inner border border-white/10">
        <p class="text-lg font-semibold mb-3 flex items-center justify-center gap-2 text-white">
          <i class="fas fa-chart-line text-success text-xl"></i>
          Ø§Ù„Ø³Ø¹Ø± Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¯Ù…
        </p>
        <span id="expectedRegionalPrice" class="text-3xl font-extrabold text-success drop-shadow">--</span> <span class="text-white">Ø¬</span>
      </div>

      <!-- Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© -->
      <div class="glass-box p-6 rounded-2xl shadow-inner border border-white/10">
        <p class="text-lg font-semibold mb-3 flex items-center justify-center gap-2 text-white">
          <i class="fas fa-lightbulb text-warning text-xl"></i>
          Ù…Ù„Ø§Ø­Ø¸Ø©
        </p>
        <p id="regionalPriceInsight" class="text-sm text-gray-200 leading-relaxed">
          ÙŠØªÙ… Ø§Ù„Ø¢Ù† ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù…Ù† Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© ÙˆØ§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ...
        </p>
      </div>
    </div>
  </div>
</section>

<!-- ğŸ”® ØªÙˆÙ‚Ø¹Ø§Øª Ø³Ø¹Ø± Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ ÙƒÙŠØª -->
<section class="forecast-section mb-12">
  <div class="card glass-card p-8 text-center rounded-2xl shadow-2xl border border-white/20">
    
    <h2 class="text-3xl font-extrabold mb-8 flex items-center justify-center gap-3 text-white drop-shadow">
      <i class="fas fa-brain text-accent-green text-3xl"></i>
      ØªÙˆÙ‚Ø¹Ø§Øª Ø³Ø¹Ø± Ù…Ø§Ù†Ø¬Ùˆ ÙƒÙŠØª (Ø£Ø³Ø¨ÙˆØ¹ / Ø´Ù‡Ø± / 3 Ø´Ù‡ÙˆØ±)
    </h2>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙØªØ±Ø§Øª -->
    <div class="flex flex-wrap justify-center gap-4 mb-8">
      <button class="btn btn-primary px-6 py-3 rounded-xl font-semibold shadow-md hover:scale-105 transition" onclick="showForecast('week')">
        <i class="fas fa-calendar-week"></i> Ø£Ø³Ø¨ÙˆØ¹
      </button>
      <button class="btn btn-success px-6 py-3 rounded-xl font-semibold shadow-md hover:scale-105 transition" onclick="showForecast('month')">
        <i class="fas fa-calendar-alt"></i> Ø´Ù‡Ø±
      </button>

      <button class="btn btn-success px-6 py-3 rounded-xl font-semibold shadow-md hover:scale-105 transition" onclick="showForecast('month')">
      <i class="fas fa-calendar-alt"></i> 3 Ø´Ù‡ÙˆØ±
      </button>
    </div>

    <!-- Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªÙˆÙ‚Ø¹ -->
    <div id="forecastResult" class="forecast-box p-8 rounded-2xl bg-glass shadow-inner border border-white/10">
      <p class="text-2xl font-bold mb-4 flex items-center justify-center gap-3 text-white">
        <i class="fas fa-magic text-accent-blue text-2xl"></i>
        Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:
        <span id="forecastPrice" class="text-accent-blue font-extrabold drop-shadow">--</span> <span class="text-white">Ø¬Ù†ÙŠÙ‡/ÙƒØ¬Ù…</span>
      </p>
      <p class="text-lg text-gray-200 flex items-center justify-center gap-2 mb-2">
        <i class="fas fa-bullseye text-success text-xl"></i>
        Ø¯Ù‚Ø© Ø§Ù„ØªÙˆÙ‚Ø¹:
        <span id="forecastConfidence" class="text-success font-bold">--%</span>
      </p>
      <p class="text-sm mt-2 text-gray-300 italic" id="forecastNote">
        ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ÙØªØ±Ø© Ù„Ù„ØªÙˆÙ‚Ø¹
      </p>
    </div>
  </div>
</section>


        <!-- Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© -->
        <section class="interactive-map mb-8">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6">
                    <i class="fas fa-map text-accent-blue"></i>
                    Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù…Ù†Ø§Ø·Ù‚ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
                </h2>
    
                <div class="glass-panel">
                    <div class="controls">
                        <div class="control-group">
                            <label for="mapType">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø±ÙŠØ·Ø©:</label>
                            <select id="mapType" title="Ù†ÙˆØ¹ Ø§Ù„Ø®Ø±ÙŠØ·Ø©">
                                <option value="satellite">ØµÙˆØ± Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©</option>
                                <option value="hybrid">Ù…Ø®ØªÙ„Ø· (Ù‚Ù…Ø± ØµÙ†Ø§Ø¹ÙŠ + Ø·Ø±Ù‚)</option>
                                <option value="terrain">Ø§Ù„ØªØ¶Ø§Ø±ÙŠØ³</option>
                                <option value="osm">Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø´ÙˆØ§Ø±Ø¹</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label>Ø¹Ø±Ø¶:</label>
                            <select id="displayOptions">
                                <option value="mango_farms">Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ</option>
                                <option value="agriculture">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</option>
                                <option value="irrigation">Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø±ÙŠ</option>
                                <option value="markets">Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ ÙˆØ§Ù„ØªØ¬Ø§Ø±Ø©</option>
                                <option value="all">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</option>
                            </select>
                        </div>
                        
                        <div class="control-group">
                            <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØµÙˆØ±Ø©:</label>
                            <input type="date" id="imageDate" value="2024-12-01">
                        </div>
                        
                        <div class="control-group" style="align-self: end;">
                            <button class="btn btn-primary" onclick="updateMap()">
                                <i class="fas fa-sync-alt"></i>
                                ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø±ÙŠØ·Ø©
                            </button>
                        </div>
                        
                        <div class="control-group" style="align-self: end;">
                            <button class="btn btn-secondary" onclick="analyzeMangoRegion()">
                                <i class="fas fa-chart-line"></i>
                                ØªØ­Ù„ÙŠÙ„ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
                            </button>
                        </div>
                    </div>
                </div>

                <div class="map-container">
                    <div class="info-panel">
                        <div class="info-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ</div>
                        <div class="info-text">
                            <strong>Ø§Ù„Ù…ØµØ¯Ø±:</strong> Sentinel-2, Landsat-9<br>
                            <strong>Ø§Ù„Ø¯Ù‚Ø©:</strong> 10-30 Ù…ØªØ± Ù„Ù„Ø¨ÙƒØ³Ù„<br>
                            <strong>Ø§Ù„ØªØ­Ø¯ÙŠØ«:</strong> Ø£Ø³Ø¨ÙˆØ¹ÙŠ<br>
                            <strong>Ø§Ù„ØªØ®ØµØµ:</strong> ØªØ­Ù„ÙŠÙ„ Ù…Ø­Ø§ØµÙŠÙ„ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ<br>
                            <strong>Ø§Ù„Ù…ÙˆØ³Ù…:</strong> ÙŠÙˆÙ†ÙŠÙˆ - Ø³Ø¨ØªÙ…Ø¨Ø±
                        </div>
                    </div>
                    <div id="map"></div>
                </div>

                <div class="legend">
                    <div class="legend-title">Ù…ÙØªØ§Ø­ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ</div>
                    <div class="legend-items">
                        <div class="legend-item">
                            <div class="legend-color" style="background: #fb923c;"></div>
                            <span>Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„Ù…Ø«Ù…Ø±Ø©</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #fcd34d;"></div>
                            <span>Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ØµØºÙŠØ±Ø©</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #4ade80;"></div>
                            <span>Ø£Ø±Ø§Ø¶ÙŠ Ø²Ø±Ø§Ø¹ÙŠØ© Ø£Ø®Ø±Ù‰</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #06b6d4;"></div>
                            <span>Ø´Ø¨ÙƒØ§Øª Ø§Ù„Ø±ÙŠ ÙˆØ§Ù„Ù…ÙŠØ§Ù‡</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #8b5cf6;"></div>
                            <span>Ù…Ø±Ø§ÙƒØ² Ø§Ù„ØªØ¬Ù…ÙŠØ¹ ÙˆØ§Ù„ØªØ³ÙˆÙŠÙ‚</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: #ef4444;"></div>
                            <span>Ù…Ù†Ø§Ø·Ù‚ Ø­Ø¶Ø±ÙŠØ© ÙˆØ·Ø±Ù‚</span>
                        </div>
                    </div>
                </div>

                <!-- ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù… -->
                <div class="analysis-panel">
                    <div class="analysis-title">
                        <i class="fas fa-chart-pie"></i>
                        ØªØ­Ù„ÙŠÙ„ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ 2024
                    </div>
                    <div class="analysis-grid">
                        <div class="analysis-item">
                            <div class="analysis-metric" id="totalProduction">15,420</div>
                            <div class="analysis-label">Ø·Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬</div>
                        </div>
                        <div class="analysis-item">
                            <div class="analysis-metric" id="farmArea">2,847</div>
                            <div class="analysis-label">ÙØ¯Ø§Ù† Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ</div>
                        </div>
                        <div class="analysis-item">
                            <div class="analysis-metric" id="avgYield">5.4</div>
                            <div class="analysis-label">Ø·Ù†/ÙØ¯Ø§Ù† Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©</div>
                        </div>
                        <div class="analysis-item">
                            <div class="analysis-metric" id="farmsCount">184</div>
                            <div class="analysis-label">Ù…Ø²Ø±Ø¹Ø© Ù…Ø§Ù†Ø¬Ùˆ Ù†Ø´Ø·Ø©</div>
                        </div>
                    </div>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalMangoFarms">184</div>
                        <div class="stat-label">Ù…Ø²Ø±Ø¹Ø© Ù…Ø§Ù†Ø¬Ùˆ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="analysisAccuracy">94%</div>
                        <div class="stat-label">Ø¯Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeRegions">6</div>
                        <div class="stat-label">Ù…Ù†Ø·Ù‚Ø© Ø¥Ù†ØªØ§Ø¬ Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="marketCenters">12</div>
                        <div class="stat-label">Ù…Ø±ÙƒØ² ØªØ³ÙˆÙŠÙ‚</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
        <section class="regions-section mb-8">
            <h2 class="text-2xl font-bold mb-6 text-center">
                <i class="fas fa-map-marked-alt text-accent-green"></i>
                ØªÙØ§ØµÙŠÙ„ Ù…Ù†Ø§Ø·Ù‚ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
            </h2>
            <div class="grid grid-auto gap-6" id="regionsGrid">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¨Ù€ JavaScript -->
            </div>
        </section>
    </div>

    <div class="loading" id="loadingPanel">
        <div class="spinner"></div>
        <div class="loading-text">Ø¬Ø§Ø±Ù ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ...</div>
    </div>


        <!-- Ù…Ø­Ø±Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… -->
        <section class="advanced-search mb-8">
            <div class="card">
                <h2 class="text-2xl font-bold mb-6 text-center">
                    <i class="fas fa-search text-accent-green"></i>
                    Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ø¹Ù† Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
                </h2>
                
                <form id="searchForm" class="grid grid-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ</label>
                        <input type="text" id="mangoVariety" class="form-input" placeholder="ÙƒÙŠØªØŒ Ø¹ÙˆÙŠØ³ØŒ Ø²Ø¨Ø¯ÙŠØ©...">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</label>
                        <select id="region" class="form-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</option>
                            <option value="Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©">Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©</option>
                            <option value="Ø§Ù„Ø´Ø±Ù‚ÙŠØ©">Ø§Ù„Ø´Ø±Ù‚ÙŠØ©</option>
                            <option value="Ø§Ù„Ø¨Ø­ÙŠØ±Ø©">Ø§Ù„Ø¨Ø­ÙŠØ±Ø©</option>
                            <option value="Ø§Ù„Ø¬ÙŠØ²Ø©">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
                            <option value="Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©">Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-2">Ø§Ù„Ø¬ÙˆØ¯Ø©</label>
                        <select id="quality" class="form-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª</option>
                            <option value="Ù…Ù…ØªØ§Ø²">Ù…Ù…ØªØ§Ø²</option>
                            <option value="Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹">Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹</option>
                            <option value="Ø¬ÙŠØ¯">Ø¬ÙŠØ¯</option>
                            <option value="ØªØµØ¯ÙŠØ±">ØªØµØ¯ÙŠØ±</option>
                        </select>
                    </div>
                </form>
                
                <div class="advanced-filters">
                    <div class="filter-group">
                        <label class="form-label">Ø§Ù„Ù…Ø³Ø§Ø­Ø© (ÙØ¯Ø§Ù†)</label>
                        <div class="range-container">
                            <input type="range" id="areaMin" class="range-input" min="0" max="1000" value="0">
                            <span class="range-value" id="areaMinValue">0</span>
                        </div>
                        <div class="range-container">
                            <input type="range" id="areaMax" class="range-input" min="0" max="1000" value="1000">
                            <span class="range-value" id="areaMaxValue">1000</span>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label class="form-label">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© (Ø·Ù†/ÙØ¯Ø§Ù†)</label>
                        <div class="range-container">
                            <input type="range" id="productivityMin" class="range-input" min="0" max="30" value="0" step="0.5">
                            <span class="range-value" id="productivityMinValue">0</span>
                        </div>
                        <div class="range-container">
                            <input type="range" id="productivityMax" class="range-input" min="0" max="30" value="30" step="0.5">
                            <span class="range-value" id="productivityMaxValue">30</span>
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label class="form-label">Ø§Ù„Ù…ÙˆØ³Ù…</label>
                        <select id="season" class="form-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø³Ù…</option>
                            <option value="Ù…Ø¨ÙƒØ±">Ù…Ø¨ÙƒØ±</option>
                            <option value="Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…">Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…</option>
                            <option value="Ù…ØªØ£Ø®Ø±">Ù…ØªØ£Ø®Ø±</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="form-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø±ÙŠ</label>
                        <select id="irrigation" class="form-select">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ø±Ù‚</option>
                            <option value="ØªÙ†Ù‚ÙŠØ·">ØªÙ†Ù‚ÙŠØ·</option>
                            <option value="Ø±Ø´">Ø±Ø´</option>
                            <option value="ØºÙ…Ø±">ØºÙ…Ø±</option>
                            <option value="Ù…Ø­ÙˆØ±ÙŠ">Ù…Ø­ÙˆØ±ÙŠ</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex flex-center gap-4 mb-6">
                    <button type="submit" form="searchForm" class="btn btn-primary">
                        <i class="fas fa-search"></i>
                        Ø¨Ø­Ø« Ù…ØªÙ‚Ø¯Ù…
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="resetSearch()">
                        <i class="fas fa-undo"></i>
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                    </button>
                </div>
                
                <!-- Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« -->
                <div id="searchResults" class="mt-6">
                    <div class="text-center mb-4">
                        <span class="text-lg font-semibold" id="resultsCount">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</span>
                    </div>
                    <div class="grid grid-auto gap-4" id="resultsGrid">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø« Ù‡Ù†Ø§ -->
                    </div>
                </div>
            </div>
        </section>

<!-- Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© -->
<section class="data-sources mb-12">
  <div class="card bg-glass p-8 rounded-2xl shadow-lg">
    <h2 class="text-2xl font-bold mb-10 text-center text-white">
      <i class="fas fa-database text-accent-blue mr-2"></i>
      Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© ÙˆØ§Ù„Ù…ÙˆØ«Ù‚Ø©
    </h2>

    <!-- Ø§Ù„Ø´Ø¨ÙƒØ© -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">

      <!-- Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© -->
      <div class="bg-glass rounded-2xl p-6 text-center shadow-md hover:shadow-xl transition">
        <div class="flex justify-center mb-4">
          <div class="p-5 rounded-full shadow-md" style="background: linear-gradient(135deg,#4facfe,#00f2fe);">
            <i class="fas fa-satellite text-white text-2xl"></i>
          </div>
        </div>
        <h3 class="text-lg font-semibold text-white mb-2">Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©</h3>
        <div class="flex items-center justify-center gap-2 mb-3">
          <span class="status-dot bg-success animate-pulse"></span>
          <span class="text-success text-sm">Ù…ØªØµÙ„ ÙˆÙ†Ø´Ø·</span>
        </div>
        <div class="text-3xl font-bold text-accent-green mb-2" id="satelliteData">2,847</div>
        <p class="text-secondary">Ù…Ø²Ø±Ø¹Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¹Ø¨Ø± Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©</p>
        <div class="text-sm text-accent-blue mt-2">Ø¯Ù‚Ø© 98.7%</div>
      </div>

      <!-- Ø§Ù„Ø³ÙˆØ´ÙŠØ§Ù„ Ù…ÙŠØ¯ÙŠØ§ -->
      <div class="bg-glass rounded-2xl p-6 text-center shadow-md hover:shadow-xl transition">
        <div class="flex justify-center mb-4">
          <div class="p-5 rounded-full shadow-md" style="background: linear-gradient(135deg,#ff6a00,#ee0979);">
            <i class="fab fa-facebook text-white text-2xl"></i>
          </div>
        </div>
        <h3 class="text-lg font-semibold text-white mb-2">ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ</h3>
        <div class="flex items-center justify-center gap-2 mb-3">
          <span class="status-dot bg-success animate-pulse"></span>
          <span class="text-success text-sm">Ù…ØªØµÙ„ ÙˆÙ†Ø´Ø·</span>
        </div>
        <div class="text-3xl font-bold text-accent-green mb-2" id="socialData">12.4K</div>
        <p class="text-secondary">ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ù† Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ÙŠÙ† ÙˆØ§Ù„ØªØ¬Ø§Ø±</p>
        <div class="text-sm text-accent-blue mt-2">ØªØ­Ø¯ÙŠØ« Ù…Ø¨Ø§Ø´Ø±</div>
      </div>

      <!-- Ø§Ù„Ø£Ø±ØµØ§Ø¯ -->
      <div class="bg-glass rounded-2xl p-6 text-center shadow-md hover:shadow-xl transition">
        <div class="flex justify-center mb-4">
          <div class="p-5 rounded-full shadow-md" style="background: linear-gradient(135deg,#56ccf2,#2f80ed);">
            <i class="fas fa-cloud-sun text-white text-2xl"></i>
          </div>
        </div>
        <h3 class="text-lg font-semibold text-white mb-2">Ù…Ø­Ø·Ø§Øª Ø§Ù„Ø£Ø±ØµØ§Ø¯</h3>
        <div class="flex items-center justify-center gap-2 mb-3">
          <span class="status-dot bg-success animate-pulse"></span>
          <span class="text-success text-sm">Ù…ØªØµÙ„ ÙˆÙ†Ø´Ø·</span>
        </div>
        <div class="text-3xl font-bold text-accent-green mb-2" id="weatherData">32Â°</div>
        <p class="text-secondary">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© ÙˆØ§Ù„Ø±Ø·ÙˆØ¨Ø© Ø§Ù„Ù…Ø«Ù„Ù‰</p>
        <div class="text-sm text-accent-blue mt-2">65% Ø±Ø·ÙˆØ¨Ø©</div>
      </div>

      <!-- Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ -->
      <div class="bg-glass rounded-2xl p-6 text-center shadow-md hover:shadow-xl transition">
        <div class="flex justify-center mb-4">
          <div class="p-5 rounded-full shadow-md" style="background: linear-gradient(135deg,#11998e,#38ef7d);">
            <i class="fas fa-chart-line text-white text-2xl"></i>
          </div>
        </div>
        <h3 class="text-lg font-semibold text-white mb-2">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³ÙˆØ§Ù‚</h3>
        <div class="flex items-center justify-center gap-2 mb-3">
          <span class="status-dot bg-success animate-pulse"></span>
          <span class="text-success text-sm">Ù…ØªØµÙ„ ÙˆÙ†Ø´Ø·</span>
        </div>
        <div class="text-3xl font-bold text-accent-green mb-2" id="marketData">47</div>
        <p class="text-secondary">Ø³ÙˆÙ‚ Ù…Ø±ÙƒØ²ÙŠ ÙˆØªØ§Ø¬Ø± Ø¬Ù…Ù„Ø©</p>
        <div class="text-sm text-accent-blue mt-2">API Ù…Ø¨Ø§Ø´Ø±</div>
      </div>

    </div>
  </div>
</section>




        
  <style>
        :root {
            --primary: #1e40af;
            --secondary: #059669;
            --accent-blue: #0ea5e9;
            --accent-green: #10b981;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --mango-color: #fb923c;
            --glass-bg: rgba(255, 255, 255, 0.15);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            direction: rtl;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.8rem;
            font-weight: bold;
            color: white;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.3rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 20px;
        }

        .badge {
            display: inline-block;
            padding: 8px 16px;
            background: var(--mango-color);
            color: white;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0 5px;
        }

        .glass-panel, .card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .interactive-map {
            margin-bottom: 30px;
        }

        .map-controls {
            margin-bottom: 20px;
        }

        .flex {
            display: flex;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .flex-center {
            justify-content: center;
            align-items: center;
        }

        .gap-4 {
            gap: 1rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        .mb-8 {
            margin-bottom: 2rem;
        }

        .text-2xl {
            font-size: 1.5rem;
        }

        .font-bold {
            font-weight: bold;
        }

        .text-center {
            text-align: center;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #1e3a8a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #047857;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #16a34a;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .form-input {
            padding: 12px;
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            transition: all 0.3s ease;
            max-width: 300px;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        label {
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }

        select, input[type="date"] {
            padding: 12px;
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        select:focus, input[type="date"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .map-container {
            position: relative;
            margin-bottom: 30px;
        }

        #map {
            height: 700px;
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid var(--glass-border);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .info-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--glass-border);
            max-width: 300px;
        }

        .info-title {
            color: white;
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .info-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .legend {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            margin-bottom: 30px;
        }

        .legend-title {
            color: white;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .legend-items {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            margin-bottom: 5px;
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }

        .grid {
            display: grid;
        }

        .grid-auto {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .region-card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .region-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .region-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .region-title {
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .region-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-excellent {
            background: var(--success);
            color: white;
        }

        .status-good {
            background: var(--accent-blue);
            color: white;
        }

        .status-average {
            background: var(--warning);
            color: white;
        }

        .region-details {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .detail-label {
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success) 0%, var(--mango-color) 100%);
            transition: width 0.5s ease;
        }

        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            z-index: 2000;
            display: none;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-weight: 600;
            text-align: center;
        }

        .custom-popup {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 300px;
        }

        .popup-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .popup-content {
            color: var(--text-primary);
            line-height: 1.5;
        }

        .popup-detail {
            margin: 5px 0;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
        }

        .popup-highlight {
            color: var(--mango-color);
            font-weight: bold;
        }

        .analysis-panel {
            background: linear-gradient(135deg, var(--glass-bg), rgba(251, 146, 60, 0.1));
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .analysis-title {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .analysis-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .analysis-metric {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--mango-color);
            margin-bottom: 5px;
        }

        .analysis-label {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .controls {
                grid-template-columns: 1fr;
            }
            
            #map {
                height: 500px;
            }
            
            .info-panel {
                position: static;
                margin-bottom: 20px;
            }
            
            .flex {
                flex-direction: column;
            }
            
            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>



<!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
        <section class="control-panel mb-8">
            <div class="card text-center">
                <h2 class="text-2xl font-bold mb-6">
                    <i class="fas fa-cog text-accent-blue"></i>
                    Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                </h2>
                <div class="flex flex-wrap gap-4 flex-center">
                    <button class="btn btn-primary" onclick="updateAllData()">
                        <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø´Ø§Ù…Ù„
                    </button>
                    <button class="btn btn-success" onclick="exportData()">
                        <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    </button>
                    <button class="btn btn-warning" onclick="showAnalytics()">
                        <i class="fas fa-chart-line"></i> ØªØ­Ù„ÙŠÙ„ Ù…ØªÙ‚Ø¯Ù…
                    </button>
                    <button class="btn btn-info" onclick="generateReport()">
                        <i class="fas fa-file-alt"></i> ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„
                    </button>
                    <button class="btn btn-secondary" onclick="showSettings()">
                        <i class="fas fa-cogs"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </button>
                </div>
            </div>
        </section>
    </div>
    
    <!-- Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ØªØ­Ø¯ÙŠØ« -->
    <div class="update-status" id="updateStatus">
        <div class="status-dot animate-pulse"></div>
        <span id="updateText">Ù…ØªØµÙ„ Ù…Ø¨Ø§Ø´Ø±</span>
    </div>
    
    <!-- Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <div class="update-indicator" id="updateIndicator">
        <i class="fas fa-sync-alt animate-spin"></i>
        <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...</span>
    </div>
    
    <!-- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø§Ù…Ø© -->
    <div class="loading" id="globalLoading">
        <div class="spinner"></div>
        <p class="mt-4">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
    </div>









    <!-------------------- JavaScript ----------------------------------->
    
    
    
    <script>


// ======== ÙˆØ­Ø¯Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ========
class MangoTrackingApp {
    constructor() {
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        this.config = {
            apiEndpoints: {
                prices: 'https://api.example.com/prices',
                regions: 'https://api.example.com/regions',
                forecasts: 'https://api.example.com/forecasts'
            },
            updateInterval: 30000, // 30 Ø«Ø§Ù†ÙŠØ©
            cacheExpiry: 600000, // 10 Ø¯Ù‚Ø§Ø¦Ù‚
            mapCenter: [30.0444, 31.2357],
            mapZoom: 6
        };
        
        // Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        this.state = {
            data: {
                mangoDatabase: [],
                filteredResults: [],
                regions: [],
                prices: {},
                forecasts: {}
            },
            ui: {
                currentSort: 'area',
                loading: false,
                lastUpdate: null
            },
            map: null,
            charts: {}
        };
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        this.init();
    }
    
    // ======== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ========
    async init() {
        try {
            console.log('ğŸ¥­ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª...');
            
            // ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆÙØ± Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø©
            this.checkBrowserCompatibility();
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
            this.setupEventListeners();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ø­Ù„ÙŠØ§Ù‹
            await this.loadCachedData();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…
            await this.fetchInitialData();
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
            this.initializeComponents();
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
            this.startAutoUpdates();
            
            console.log('âœ… ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…:', error);
            this.showError('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ØŒ ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©');
        }
    }
    
    // ======== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆØ§ÙÙ‚ Ø§Ù„Ù…ØªØµÙØ­ ========
    checkBrowserCompatibility() {
        const requiredFeatures = [
            'fetch',
            'Promise',
            'localStorage',
            'IntersectionObserver',
            'ServiceWorker'
        ];
        
        const missingFeatures = requiredFeatures.filter(feature => !(feature in window));
        
        if (missingFeatures.length > 0) {
            console.warn('âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ ÙŠÙØªÙ‚Ø¯ Ø¥Ù„Ù‰ Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙŠØ²Ø§Øª:', missingFeatures);
            // ÙŠÙ…ÙƒÙ† Ù‡Ù†Ø§ Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ØªÙˆÙÙŠØ± Ø¨Ø¯ÙŠÙ„
        }
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ========
    setupEventListeners() {
        // Ù…Ù†Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', (e) => e.preventDefault());
        });
        
        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¨Ø­Ø«
        const searchInput = document.getElementById('mangoVariety');
        if (searchInput) {
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… debounce Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
            searchInput.addEventListener('input', this.debounce(() => {
                this.performSearch();
            }, 500));
        }
        
        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ÙÙ„Ø§ØªØ±
        ['region', 'quality', 'season', 'irrigation'].forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                element.addEventListener('change', () => this.performSearch());
            }
        });
        
        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù€ sliders
        ['areaMin', 'areaMax', 'productivityMin', 'productivityMax'].forEach(id => {
            const slider = document.getElementById(id);
            if (slider) {
                slider.addEventListener('input', () => {
                    this.updateSliderValues();
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… throttle Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ ØªÙƒØ±Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«
                    this.throttle(() => this.performSearch(), 300)();
                });
            }
        });
        
        // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ÙØ±Ø²
        document.querySelectorAll('.sort-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                this.state.ui.currentSort = btn.dataset.sort;
                this.displayResults(this.state.data.filteredResults);
            });
        });
        
        // Ø£Ø­Ø¯Ø§Ø« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        this.setupControlPanelEvents();
        
        // Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù‚Ø¨Ù„ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', () => this.saveAppState());
    }
    
    // ======== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ ========
    async loadCachedData() {
        try {
            // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
            const cachedData = localStorage.getItem('mangoTrackingData');
            
            if (cachedData) {
                const parsedData = JSON.parse(cachedData);
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©
                if (this.isDataValid(parsedData)) {
                    console.log('ğŸ“¦ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ');
                    this.state.data = { ...this.state.data, ...parsedData };
                    this.displayResults(this.state.data.filteredResults);
                    return;
                }
            }
            
            console.log('ğŸ”„ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©:', error);
        }
    }
    
    // ======== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ========
    isDataValid(data) {
        if (!data || !data.lastUpdate) return false;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const now = new Date().getTime();
        const dataAge = now - new Date(data.lastUpdate).getTime();
        
        return dataAge < this.config.cacheExpiry;
    }
    
    // ======== Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ========
    async fetchInitialData() {
        this.showLoader(true);
        
        try {
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Promise.all Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ù…ØªÙˆØ§Ø²Ù
            const [mangoData, regionsData, pricesData, forecastsData] = await Promise.all([
                this.fetchMangoData(),
                this.fetchRegionsData(),
                this.fetchPricesData(),
                this.fetchForecastsData()
            ]);
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            this.state.data.mangoDatabase = mangoData;
            this.state.data.filteredResults = [...mangoData];
            this.state.data.regions = regionsData;
            this.state.data.prices = pricesData;
            this.state.data.forecasts = forecastsData;
            this.state.ui.lastUpdate = new Date();
            
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
            this.saveDataLocally();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            this.updateDashboard();
            this.displayResults(this.state.data.filteredResults);
            
            console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            this.showError('ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª');
        } finally {
            this.showLoader(false);
        }
    }
    
    // ======== Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ ========
    async fetchMangoData() {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† API
        // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù‡Ø°Ø§ Ø¨Ù€ fetch Ø­Ù‚ÙŠÙ‚ÙŠ
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve(this.getMangoDatabase());
            }, 1000);
        });
    }
    
    // ======== Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ========
    async fetchRegionsData() {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† API
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve([
                    { name: "Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©", farms: 340, quantity: 980, price: 45 },
                    { name: "Ø§Ù„Ø¨Ø­ÙŠØ±Ø©", farms: 220, quantity: 720, price: 44 },
                    { name: "Ø§Ù„Ø¬ÙŠØ²Ø©", farms: 180, quantity: 600, price: 49 },
                    { name: "Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©", farms: 150, quantity: 520, price: 46 },
                    { name: "Ø§Ù„Ø´Ø±Ù‚ÙŠØ©", farms: 290, quantity: 850, price: 47 }
                ]);
            }, 800);
        });
    }
    
    // ======== Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ========
    async fetchPricesData() {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† API
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve({
                    current: 65,
                    historical: [62, 63, 64, 65, 65, 65],
                    regions: {
                        "Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©": 45,
                        "Ø§Ù„Ø´Ø±Ù‚ÙŠØ©": 47,
                        "Ø§Ù„Ø¨Ø­ÙŠØ±Ø©": 44,
                        "Ø§Ù„Ø¬ÙŠØ²Ø©": 49,
                        "Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©": 46
                    },
                    lastUpdate: new Date().toISOString()
                });
            }, 1200);
        });
    }
    
    // ======== Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª ========
    async fetchForecastsData() {
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† API
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve({
                    week: {
                        labels: ['Ø§Ù„ÙŠÙˆÙ…', 'ØºØ¯Ù‹Ø§', '2 Ø£ÙŠØ§Ù…', '3 Ø£ÙŠØ§Ù…', '4 Ø£ÙŠØ§Ù…', '5 Ø£ÙŠØ§Ù…', '6 Ø£ÙŠØ§Ù…'],
                        values: [65, 65.5, 66, 66.5, 67, 67.5, 68],
                        price: 68,
                        confidence: 92
                    },
                    month: {
                        labels: ['Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„'],
                        values: [65, 69],
                        price: 69,
                        confidence: 88
                    },
                    quarter: {
                        labels: ['Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ'],
                        values: [65, 69, 72],
                        price: 72,
                        confidence: 85
                    }
                });
            }, 1500);
        });
    }
    
    // ======== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª ========
    initializeComponents() {
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        this.initializeMap();
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
        this.initializeCharts();
        
        // ØªÙ‡ÙŠØ¦Ø© ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        this.initializeUIEffects();
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ IntersectionObserver Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØ³ÙˆÙ„
        this.setupLazyLoading();
    }
    
    // ======== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© ========
    initializeMap() {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù†ØµØ± Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        const mapContainer = document.getElementById('map');
        if (!mapContainer) return;
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        this.state.map = L.map('map').setView(
            this.config.mapCenter, 
            this.config.mapZoom
        );
        
        // Ø¥Ø¶Ø§ÙØ© Ø·Ø¨Ù‚Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 18
        }).addTo(this.state.map);
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ø®ØµØµØ©
        this.setupMapIcons();
        
        console.log('ğŸ—ºï¸ ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø¨Ù†Ø¬Ø§Ø­');
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø®Ø±ÙŠØ·Ø© ========
    setupMapIcons() {
        // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹
        this.farmIcon = L.icon({
            iconUrl: 'https://cdn-icons-png.flaticon.com/512/766/766570.png',
            iconSize: [32, 32],
            iconAnchor: [16, 32],
            popupAnchor: [0, -30]
        });
        
        // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø£Ø³ÙˆØ§Ù‚
        this.marketIcon = L.icon({
            iconUrl: 'https://cdn-icons-png.flaticon.com/512/3075/3075977.png',
            iconSize: [30, 30],
            iconAnchor: [15, 30],
            popupAnchor: [0, -30]
        });
    }
    



    // ======== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ========
    initializeCharts() {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
        const chartElements = [
            'priceChart', 
            'quantityChart', 
            'productivityChart', 
            'trendChart',
            'forecastChart'
        ];
        
        chartElements.forEach(id => {
            const element = document.getElementById(id);
            if (element) {
                this.createChart(id);
            }
        });
        
        console.log('ğŸ“Š ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­');
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ ========
    createChart(id) {
        const ctx = document.getElementById(id).getContext('2d');
        
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø© Ù„Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
        const defaultOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        color: '#e2e8f0',
                        font: {
                            family: 'Cairo, sans-serif'
                        }
                    }
                },
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    titleFont: {
                        family: 'Cairo, sans-serif',
                        size: 14
                    },
                    bodyFont: {
                        family: 'Cairo, sans-serif',
                        size: 13
                    },
                    padding: 12,
                    cornerRadius: 8
                }
            },
            scales: {
                y: {
                    grid: {
                        color: 'rgba(255, 255, 255, 0.1)'
                    },
                    ticks: {
                        color: 'rgba(255, 255, 255, 0.7)',
                        font: {
                            family: 'Cairo, sans-serif'
                        }
                    }
                },
                x: {
                    grid: {
                        color: 'rgba(255, 255, 255, 0.1)'
                    },
                    ticks: {
                        color: 'rgba(255, 255, 255, 0.7)',
                        font: {
                            family: 'Cairo, sans-serif'
                        }
                    }
                }
            }
        };
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø±Ù
        switch(id) {
            case 'priceChart':
                this.state.charts.priceChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(this.state.data.prices.regions || {}),
                        datasets: [{
                            label: 'Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡',
                            data: Object.values(this.state.data.prices.regions || {}),
                            backgroundColor: [
                                'rgba(102, 126, 234, 0.8)',
                                'rgba(118, 75, 162, 0.8)',
                                'rgba(240, 147, 251, 0.8)',
                                'rgba(244, 114, 182, 0.8)',
                                'rgba(251, 146, 60, 0.8)'
                            ],
                            borderColor: [
                                'rgba(102, 126, 234, 1)',
                                'rgba(118, 75, 162, 1)',
                                'rgba(240, 147, 251, 1)',
                                'rgba(244, 114, 182, 1)',
                                'rgba(251, 146, 60, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: defaultOptions
                });
                break;
                
            case 'quantityChart':
                this.state.charts.quantityChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: Object.keys(this.state.data.prices.regions || {}),
                        datasets: [{
                            data: Object.values(this.state.data.regions.map(r => r.quantity) || []),
                            backgroundColor: [
                                'rgba(102, 126, 234, 0.8)',
                                'rgba(118, 75, 162, 0.8)',
                                'rgba(240, 147, 251, 0.8)',
                                'rgba(244, 114, 182, 0.8)',
                                'rgba(251, 146, 60, 0.8)'
                            ],
                            borderColor: [
                                'rgba(102, 126, 234, 1)',
                                'rgba(118, 75, 162, 1)',
                                'rgba(240, 147, 251, 1)',
                                'rgba(244, 114, 182, 1)',
                                'rgba(251, 146, 60, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        ...defaultOptions,
                        cutout: '60%'
                    }
                });
                break;
                
            case 'productivityChart':
                this.state.charts.productivityChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'],
                        datasets: [{
                            label: 'Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©',
                            data: [12, 15.2, 14, 16.5, 17],
                            borderColor: 'rgba(79, 172, 254, 1)',
                            backgroundColor: 'rgba(79, 172, 254, 0.2)',
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: 'rgba(79, 172, 254, 1)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                            pointHoverRadius: 8
                        }]
                    },
                    options: defaultOptions
                });
                break;
                
            case 'trendChart':
                this.state.charts.trendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'],
                        datasets: [{
                            label: 'Ø§Ù„Ø³Ø¹Ø±',
                            data: [40, 42, 43, 45, 47, 48],
                            borderColor: 'rgba(239, 68, 68, 1)',
                            backgroundColor: 'rgba(239, 68, 68, 0.2)',
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: 'rgba(239, 68, 68, 1)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                            pointHoverRadius: 8
                        }]
                    },
                    options: defaultOptions
                });
                break;
                
            case 'forecastChart':
                // Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ Ø¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ¯ ÙØªØ±Ø© Ø§Ù„ØªÙˆÙ‚Ø¹
                break;
        }
    }
    
    // ======== ØªÙ‡ÙŠØ¦Ø© ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ========
    initializeUIEffects() {
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ÙˆØ¬Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø±
        document.querySelectorAll('.ripple-effect').forEach(element => {
            element.addEventListener('click', (e) => this.createRipple(e, element));
        });
        
        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠØ±
        this.setupScrollEffects();
        
        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ©
        this.setupAnimationEffects();
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ IntersectionObserver Ù„Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØ³ÙˆÙ„ ========
    setupLazyLoading() {
        if ('IntersectionObserver' in window) {
            const lazyElements = document.querySelectorAll('.lazy-load');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const element = entry.target;
                        element.classList.add('loaded');
                        
                        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                        if (element.dataset.src) {
                            element.src = element.dataset.src;
                        }
                        
                        observer.unobserve(element);
                    }
                });
            }, {
                rootMargin: '50px'
            });
            
            lazyElements.forEach(element => {
                observer.observe(element);
            });
        }
    }
    
    // ======== Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ========
    startAutoUpdates() {
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ
        setInterval(() => {
            this.updateData();
        }, this.config.updateInterval);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø©
        this.updateClock();
        setInterval(() => this.updateClock(), 1000);
        
        console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©');
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ========
    async updateData() {
        try {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
            const newPrices = await this.fetchPricesData();
            this.state.data.prices = newPrices;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª
            const newForecasts = await this.fetchForecastsData();
            this.state.data.forecasts = newForecasts;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            this.updateDashboard();
            this.updateCharts();
            
            // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¯ÙŠØ«
            this.state.ui.lastUpdate = new Date();
            document.getElementById('lastUpdate').textContent = 'Ø§Ù„Ø¢Ù†';
            
            // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
            this.saveDataLocally();
            
            console.log('ğŸ”„ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        } catch (error) {
            console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
        }
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ========
    updateDashboard() {
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        const stats = this.calculateStatistics();
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        this.updateElement('totalRegions', stats.totalRegions);
        this.updateElement('availableCount', stats.availableCount);
        this.updateElement('totalFarms', stats.totalFarms);
        this.updateElement('totalQuantity', stats.totalQuantity.toLocaleString('ar-EG'));
        this.updateElement('averagePrice', `${stats.averagePrice} Ø¬/Ùƒ`);
        
        // ØªØ­Ø¯ÙŠØ« Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        this.updateDataSources();
        
        // ØªØ­Ø¯ÙŠØ« ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠØ©
        this.updateRegionalForecast();
    }
    
    // ======== Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ========
    calculateStatistics() {
        const data = this.state.data.mangoDatabase;
        
        return {
            totalRegions: new Set(data.map(item => item.region)).size,
            availableCount: data.filter(item => item.quality === 'Ù…Ù…ØªØ§Ø²' || item.quality === 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹').length,
            totalFarms: data.length,
            totalQuantity: data.reduce((sum, item) => sum + (item.area * item.productivity), 0),
            averagePrice: this.state.data.prices.current || 0
        };
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ø¹Ù†ØµØ± ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ========
    updateElement(id, value) {
        const element = document.getElementById(id);
        if (element) {
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø­Ø±ÙƒÙŠ
            element.style.transform = 'scale(1.1)';
            element.style.transition = 'transform 0.3s ease';
            
            setTimeout(() => {
                element.textContent = value;
                element.style.transform = 'scale(1)';
            }, 150);
        }
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ù…ØµØ§Ø¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ========
    updateDataSources() {
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ù‚Ù…Ø§Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©
        this.animateValue('satelliteData', 0, 2847, 2000);
        
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ
        this.animateValue('socialData', 0, 12400, 2000, true);
        
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ø·Ø§Øª Ø§Ù„Ø£Ø±ØµØ§Ø¯
        this.updateElement('weatherData', '32Â°');
        
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³ÙˆØ§Ù‚
        this.animateValue('marketData', 0, 47, 1500);
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø¥Ù‚Ù„ÙŠÙ…ÙŠØ© ========
    updateRegionalForecast() {
        const prices = this.state.data.prices.regions || {};
        const avgPrice = Object.values(prices).reduce((sum, price) => sum + price, 0) / Object.keys(prices).length;
        const expectedPrice = avgPrice * 0.99; // ØªÙˆÙ‚Ø¹ Ø§Ù†Ø®ÙØ§Ø¶ Ø¨Ù†Ø³Ø¨Ø© 1%
        
        this.updateElement('avgWeeklyRegionalPrice', `${avgPrice.toFixed(2)} Ø¬`);
        this.updateElement('expectedRegionalPrice', `${expectedPrice.toFixed(2)} Ø¬`);
        
        document.getElementById('regionalPriceInsight').textContent = 
            'Ù…Ù† Ù…ØµØ§Ø¯Ø± Ø¯Ø§Ø®Ù„ÙŠØ© + ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø±Ù‚Ù…ÙŠ (Tridge + ØªÙ‚Ø§Ø±ÙŠØ± Ù…Ø­Ù„ÙŠØ©)';
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© ========
    updateCharts() {
        // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
        if (this.state.charts.priceChart) {
            this.state.charts.priceChart.data.labels = Object.keys(this.state.data.prices.regions || {});
            this.state.charts.priceChart.data.datasets[0].data = Object.values(this.state.data.prices.regions || {});
            this.state.charts.priceChart.update('active');
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„ÙƒÙ…ÙŠØ§Øª
        if (this.state.charts.quantityChart) {
            this.state.charts.quantityChart.data.labels = Object.keys(this.state.data.prices.regions || {});
            this.state.charts.quantityChart.data.datasets[0].data = this.state.data.regions.map(r => r.quantity);
            this.state.charts.quantityChart.update('active');
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø§ØªØ¬Ø§Ù‡
        if (this.state.charts.trendChart) {
            this.state.charts.trendChart.data.datasets[0].data = this.state.data.prices.historical || [];
            this.state.charts.trendChart.update('active');
        }
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø­Ø¯Ø§Ø« Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ========
    setupControlPanelEvents() {
        // Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        document.querySelector('[onclick="updateAllData()"]')?.addEventListener('click', () => {
            this.updateAllData();
        });
        
        // Ø²Ø± ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        document.querySelector('[onclick="exportData()"]')?.addEventListener('click', () => {
            this.exportData();
        });
        
        // Ø²Ø± Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        document.querySelector('[onclick="showAnalytics()"]')?.addEventListener('click', () => {
            this.showAnalytics();
        });
        
        // Ø²Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        document.querySelector('[onclick="generateReport()"]')?.addEventListener('click', () => {
            this.generateReport();
        });
        
        // Ø²Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        document.querySelector('[onclick="showSettings()"]')?.addEventListener('click', () => {
            this.showSettings();
        });
        
        // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        this.setupMapControls();
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ========
    setupMapControls() {
        // Ø²Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
        document.querySelector('[onclick="getCurrentLocation()"]')?.addEventListener('click', () => {
            this.getCurrentLocation();
        });
        
        // Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹
        document.querySelector('[onclick="addMangoFarms()"]')?.addEventListener('click', () => {
            this.addMangoFarms();
        });
        
        // Ø²Ø± Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø£Ø³ÙˆØ§Ù‚
        document.querySelector('[onclick="showMarkets()"]')?.addEventListener('click', () => {
            this.showMarkets();
        });
        
        // Ø²Ø± Ù…Ø³Ø­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        document.querySelector('[onclick="clearMap()"]')?.addEventListener('click', () => {
            this.clearMap();
        });
        
        // Ø²Ø± Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        const searchButton = document.querySelector('[onclick="searchLocation()"]');
        const searchInput = document.getElementById('searchLocation');
        
        if (searchButton && searchInput) {
            searchButton.addEventListener('click', () => {
                this.searchLocation(searchInput.value);
            });
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    this.searchLocation(searchInput.value);
                }
            });
        }
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ========
    async updateAllData() {
        this.showLoader(true);
        this.showUpdateIndicator(true);
        
        try {
            await this.fetchInitialData();
            this.showNotification('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            this.showNotification('âŒ ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
        } finally {
            this.showLoader(false);
            this.showUpdateIndicator(false);
        }
    }
    
    // ======== ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ========
    exportData() {
        try {
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ù…Ù„Ù CSV
            const headers = [
                'Ø§Ù„ØµÙ†Ù', 'Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ù„Ù…ÙŠ', 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø©', 'Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©', 'Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©', 
                'Ø§Ù„Ù…Ø³Ø§Ø­Ø© (ÙØ¯Ø§Ù†)', 'Ø§Ù„Ø¬ÙˆØ¯Ø©', 'Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© (Ø·Ù†/ÙØ¯Ø§Ù†)', 'Ø§Ù„Ù…ÙˆØ³Ù…', 'Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø±ÙŠ'
            ];
            
            const rows = this.state.data.mangoDatabase.map(item => [
                item.variety,
                item.scientificName,
                item.region,
                item.governorate,
                item.city,
                item.area,
                item.quality,
                item.productivity,
                item.season,
                item.irrigation
            ]);
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù CSV
            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.join(','))
            ].join('\n');
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `Ø¨ÙŠØ§Ù†Ø§Øª_Ù…Ø§Ù†Ø¬Ùˆ_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            this.showNotification('ğŸ“¥ ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            this.showNotification('âŒ ÙØ´Ù„ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
        }
    }
    
    // ======== Ø¹Ø±Ø¶ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© ========
    showAnalytics() {
        // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
        const modal = this.createModal('Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©', this.generateAnalyticsContent());
        document.body.appendChild(modal);
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ© Ø¯Ø§Ø®Ù„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        setTimeout(() => {
            this.initializeAnalyticsCharts();
        }, 100);
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ========
    generateAnalyticsContent() {
        return `
            <div class="analytics-container">
                <div class="grid grid-2 gap-6">
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù Ø­Ø³Ø¨ Ø§Ù„Ø¬ÙˆØ¯Ø©</h3>
                        <canvas id="qualityDistributionChart" width="400" height="300"></canvas>
                    </div>
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø© ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©</h3>
                        <canvas id="areaProductivityChart" width="400" height="300"></canvas>
                    </div>
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©</h3>
                        <canvas id="geographicDistributionChart" width="400" height="300"></canvas>
                    </div>
                    <div class="card">
                        <h3 class="text-xl font-bold mb-4">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø­ÙŠØ©</h3>
                        <canvas id="profitabilityChart" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>
        `;
    }
    
    // ======== ØªÙ‡ÙŠØ¦Ø© Ø±Ø³ÙˆÙ… Ø¨ÙŠØ§Ù†ÙŠØ© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ========
    initializeAnalyticsCharts() {
        // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù Ø­Ø³Ø¨ Ø§Ù„Ø¬ÙˆØ¯Ø©
        const qualityData = this.state.data.mangoDatabase.reduce((acc, item) => {
            acc[item.quality] = (acc[item.quality] || 0) + 1;
            return acc;
        }, {});
        
        new Chart(document.getElementById('qualityDistributionChart'), {
            type: 'pie',
            data: {
                labels: Object.keys(qualityData),
                datasets: [{
                    data: Object.values(qualityData),
                    backgroundColor: [
                        'rgba(79, 172, 254, 0.8)',
                        'rgba(240, 147, 251, 0.8)',
                        'rgba(251, 146, 60, 0.8)',
                        'rgba(239, 68, 68, 0.8)'
                    ]
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            color: '#e2e8f0',
                            font: {
                                family: 'Cairo, sans-serif'
                            }
                        }
                    }
                }
            }
        });
        
        // Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø­Ø© ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©
        const areaProductivityData = this.state.data.mangoDatabase.map(item => ({
            x: item.area,
            y: item.productivity
        }));
        
        new Chart(document.getElementById('areaProductivityChart'), {
            type: 'scatter',
            data: {
                datasets: [{
                    label: 'Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©',
                    data: areaProductivityData,
                    backgroundColor: 'rgba(79, 172, 254, 0.6)'
                }]
            },
            options: {
                responsive: true,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Ø§Ù„Ù…Ø³Ø§Ø­Ø© (ÙØ¯Ø§Ù†)',
                            color: '#e2e8f0'
                        },
                        ticks: {
                            color: '#e2e8f0'
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© (Ø·Ù†/ÙØ¯Ø§Ù†)',
                            color: '#e2e8f0'
                        },
                        ticks: {
                            color: '#e2e8f0'
                        }
                    }
                }
            }
        });
        
        // ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ©
        const regionData = this.state.data.mangoDatabase.reduce((acc, item) => {
            acc[item.region] = (acc[item.region] || 0) + 1;
            return acc;
        }, {});
        
        new Chart(document.getElementById('geographicDistributionChart'), {
            type: 'bar',
            data: {
                labels: Object.keys(regionData),
                datasets: [{
                    label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹',
                    data: Object.values(regionData),
                    backgroundColor: 'rgba(79, 172, 254, 0.8)'
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            color: '#e2e8f0'
                        }
                    },
                    x: {
                        ticks: {
                            color: '#e2e8f0'
                        }
                    }
                }
            }
        });
        
        // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø­ÙŠØ©
        const avgPrice = this.state.data.prices.current || 0;
        const profitabilityData = this.state.data.mangoDatabase.map(item => ({
            region: item.region,
            profitability: (item.productivity * avgPrice * item.area) - (item.area * 5000) // Ø¥ÙŠØ±Ø§Ø¯Ø§Øª - ØªÙƒØ§Ù„ÙŠÙ
        }));
        
        new Chart(document.getElementById('profitabilityChart'), {
            type: 'bar',
            data: {
                labels: profitabilityData.map(item => item.region),
                datasets: [{
                    label: 'Ø§Ù„Ø±Ø¨Ø­ÙŠØ© (Ø¬Ù†ÙŠÙ‡)',
                    data: profitabilityData.map(item => item.profitability),
                    backgroundColor: profitabilityData.map(item => 
                        item.profitability > 0 ? 'rgba(79, 172, 254, 0.8)' : 'rgba(239, 68, 68, 0.8)'
                    )
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        ticks: {
                            color: '#e2e8f0'
                        }
                    },
                    x: {
                        ticks: {
                            color: '#e2e8f0'
                        }
                    }
                }
            }
        });
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± ========
    generateReport() {
        this.showLoader(true);
        
        try {
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
            const reportContent = this.generateReportContent();
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
            const modal = this.createModal('ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„', reportContent);
            document.body.appendChild(modal);
            
            this.showNotification('ğŸ“ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±:', error);
            this.showNotification('âŒ ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±', 'error');
        } finally {
            this.showLoader(false);
        }
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ========
    generateReportContent() {
        const stats = this.calculateStatistics();
        const date = new Date().toLocaleDateString('ar-EG', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
        
        return `
            <div class="report-container">
                <div class="report-header text-center mb-6">
                    <h2 class="text-2xl font-bold">ØªÙ‚Ø±ÙŠØ± Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª</h2>
                    <p class="text-secondary">ØªØ§Ø±ÙŠØ®: ${date}</p>
                </div>
                
                <div class="report-summary mb-6">
                    <h3 class="text-xl font-bold mb-3">Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ</h3>
                    <p>ÙŠØºØ·ÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø­Ø§Ù„Ø© Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ ÙÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØµØ±ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ù…Ø¹ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ© ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆØ§Ù„Ø¬ÙˆØ¯Ø©.</p>
                </div>
                
                <div class="report-stats grid grid-2 gap-4 mb-6">
                    <div class="stat-card">
                        <h4 class="font-bold mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</h4>
                        <p class="text-3xl font-bold text-accent-blue">${stats.totalRegions}</p>
                    </div>
                    <div class="stat-card">
                        <h4 class="font-bold mb-2">Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…ØªØ§Ø­Ø©</h4>
                        <p class="text-3xl font-bold text-success">${stats.availableCount}</p>
                    </div>
                    <div class="stat-card">
                        <h4 class="font-bold mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</h4>
                        <p class="text-3xl font-bold text-warning">${stats.totalFarms}</p>
                    </div>
                    <div class="stat-card">
                        <h4 class="font-bold mb-2">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</h4>
                        <p class="text-3xl font-bold text-accent-green">${stats.totalQuantity.toLocaleString('ar-EG')} Ø·Ù†</p>
                    </div>
                </div>
                
                <div class="report-section mb-6">
                    <h3 class="text-xl font-bold mb-3">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</h3>
                    <p>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ: <strong>${stats.averagePrice} Ø¬Ù†ÙŠÙ‡/ÙƒØ¬Ù…</strong></p>
                    <p>ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ù„Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ù‚Ø§Ø¯Ù…: <strong>${(stats.averagePrice * 1.02).toFixed(2)} Ø¬Ù†ÙŠÙ‡/ÙƒØ¬Ù…</strong></p>
                </div>
                
                <div class="report-section mb-6">
                    <h3 class="text-xl font-bold mb-3">ØªÙˆØµÙŠØ§Øª</h3>
                    <ul class="list-disc pr-5">
                        <li>Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ù‡ØªÙ…Ø§Ù… Ø¨Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©</li>
                        <li>ØªØ­Ø³ÙŠÙ† Ø·Ø±Ù‚ Ø§Ù„Ø±ÙŠ ÙÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø¬Ø§ÙØ©</li>
                        <li>Ø§Ù„ØªÙˆØ³Ø¹ ÙÙŠ Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„ØªØµØ¯ÙŠØ±</li>
                        <li>ØªØ·Ø¨ÙŠÙ‚ ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©</li>
                    </ul>
                </div>
                
                <div class="report-footer text-center mt-6 pt-4 border-t">
                    <p>ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ Ø§Ù„ÙƒÙŠØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</p>
                    <p class="text-sm text-secondary">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© ${new Date().getFullYear()}</p>
                </div>
            </div>
        `;
    }
    
    // ======== Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ========
    showSettings() {
        const settingsContent = `
            <div class="settings-container">
                <div class="settings-section mb-6">
                    <h3 class="text-xl font-bold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù…Ø©</h3>
                    <div class="form-group mb-4">
                        <label class="form-label">ÙØªØ±Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (Ø¨Ø§Ù„Ø«Ø§Ù†ÙŠØ©)</label>
                        <select id="updateInterval" class="form-select">
                            <option value="10000">10 Ø«ÙˆØ§Ù†ÙŠ</option>
                            <option value="30000" selected>30 Ø«Ø§Ù†ÙŠØ©</option>
                            <option value="60000">Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©</option>
                            <option value="300000">5 Ø¯Ù‚Ø§Ø¦Ù‚</option>
                        </select>
                    </div>
                    <div class="form-group mb-4">
                        <label class="form-label">Ø§Ù„Ù„ØºØ©</label>
                        <select id="language" class="form-select">
                            <option value="ar" selected>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                            <option value="en">English</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-section mb-6">
                    <h3 class="text-xl font-bold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®Ø±ÙŠØ·Ø©</h3>
                    <div class="form-group mb-4">
                        <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</label>
                        <select id="mapType" class="form-select">
                            <option value="openstreetmap" selected>OpenStreetMap</option>
                            <option value="satellite">Ø§Ù„Ù‚Ù…Ø± Ø§Ù„ØµÙ†Ø§Ø¹ÙŠ</option>
                            <option value="terrain">Ø§Ù„ØªØ¶Ø§Ø±ÙŠØ³</option>
                        </select>
                    </div>
                    <div class="form-group mb-4">
                        <label class="form-label">Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</label>
                        <input type="range" id="defaultZoom" class="form-input" min="1" max="18" value="6">
                    </div>
                </div>
                
                <div class="settings-section mb-6">
                    <h3 class="text-xl font-bold mb-4">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
                    <div class="form-check mb-3">
                        <input type="checkbox" id="priceAlerts" class="form-check-input" checked>
                        <label class="form-check-label" for="priceAlerts">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ØªØºÙŠØ± Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</label>
                    </div>
                    <div class="form-check mb-3">
                        <input type="checkbox" id="weatherAlerts" class="form-check-input" checked>
                        <label class="form-check-label" for="weatherAlerts">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ø­ÙˆØ§Ù„ Ø§Ù„Ø¬ÙˆÙŠØ©</label>
                    </div>
                    <div class="form-check mb-3">
                        <input type="checkbox" id="harvestAlerts" class="form-check-input">
                        <label class="form-check-label" for="harvestAlerts">ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ù…ÙˆØ§Ø³Ù… Ø§Ù„Ø­ØµØ§Ø¯</label>
                    </div>
                </div>
                
                <div class="text-center">
                    <button class="btn btn-primary" onclick="app.saveSettings()">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                    <button class="btn btn-secondary ml-2" onclick="app.closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            </div>
        `;
        
        const modal = this.createModal('Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª', settingsContent);
        document.body.appendChild(modal);
        
        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        document.getElementById('updateInterval').value = this.config.updateInterval;
        document.getElementById('defaultZoom').value = this.config.mapZoom;
    }
    
    // ======== Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ========
    saveSettings() {
        // ØªØ­Ø¯ÙŠØ« Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        this.config.updateInterval = parseInt(document.getElementById('updateInterval').value);
        this.config.mapZoom = parseInt(document.getElementById('defaultZoom').value);
        
        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ localStorage
        localStorage.setItem('mangoTrackingSettings', JSON.stringify(this.config));
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
        clearInterval(this.updateInterval);
        this.startAutoUpdates();
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        this.closeModal();
        
        this.showNotification('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }
    
    // ======== Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ========
    closeModal() {
        const modal = document.querySelector('.modal');
        if (modal) {
            modal.remove();
        }
    }
    
    // ======== Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø« ========
    performSearch() {
        this.showLoading(true);
        
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… Web Worker Ù„Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ¨ÙŠØ±Ø©
        if (window.Worker && this.state.data.mangoDatabase.length > 1000) {
            this.performSearchWithWorker();
        } else {
            this.performSearchDirectly();
        }
    }
    
    // ======== Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±Ø© ========
    performSearchDirectly() {
        setTimeout(() => {
            const variety = document.getElementById('mangoVariety').value.toLowerCase();
            const region = document.getElementById('region').value;
            const quality = document.getElementById('quality').value;
            const season = document.getElementById('season').value;
            const irrigation = document.getElementById('irrigation').value;
            
            const areaMin = parseInt(document.getElementById('areaMin').value);
            const areaMax = parseInt(document.getElementById('areaMax').value);
            const productivityMin = parseInt(document.getElementById('productivityMin').value);
            const productivityMax = parseInt(document.getElementById('productivityMax').value);
            
            // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            this.state.data.filteredResults = this.state.data.mangoDatabase.filter(mango => {
                const matchesVariety = !variety || mango.variety.toLowerCase().includes(variety);
                const matchesRegion = !region || mango.region === region;
                const matchesQuality = !quality || mango.quality === quality;
                const matchesSeason = !season || mango.season === season;
                const matchesIrrigation = !irrigation || mango.irrigation === irrigation;
                const matchesArea = mango.area >= areaMin && mango.area <= areaMax;
                const matchesProductivity = mango.productivity >= productivityMin && mango.productivity <= productivityMax;
                
                return matchesVariety && matchesRegion && matchesQuality && 
                       matchesSeason && matchesIrrigation && matchesArea && matchesProductivity;
            });
            
            this.hideLoading();
            this.displayResults(this.state.data.filteredResults);
        }, 300);
    }
    
    // ======== Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Web Worker ========
    performSearchWithWorker() {
        // Ø¥Ù†Ø´Ø§Ø¡ Web Worker Ù„Ù„Ø¨Ø­Ø«
        const workerCode = `
            self.onmessage = function(e) {
                const { 
                    mangoDatabase, variety, region, quality, season, irrigation,
                    areaMin, areaMax, productivityMin, productivityMax 
                } = e.data;
                
                const filteredResults = mangoDatabase.filter(mango => {
                    const matchesVariety = !variety || mango.variety.toLowerCase().includes(variety);
                    const matchesRegion = !region || mango.region === region;
                    const matchesQuality = !quality || mango.quality === quality;
                    const matchesSeason = !season || mango.season === season;
                    const matchesIrrigation = !irrigation || mango.irrigation === irrigation;
                    const matchesArea = mango.area >= areaMin && mango.area <= areaMax;
                    const matchesProductivity = mango.productivity >= productivityMin && mango.productivity <= productivityMax;
                    
                    return matchesVariety && matchesRegion && matchesQuality && 
                           matchesSeason && matchesIrrigation && matchesArea && matchesProductivity;
                });
                
                self.postMessage({ filteredResults });
            };
        `;
        
        const blob = new Blob([workerCode], { type: 'application/javascript' });
        const worker = new Worker(URL.createObjectURL(blob));
        
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù…Ù„
        worker.postMessage({
            mangoDatabase: this.state.data.mangoDatabase,
            variety: document.getElementById('mangoVariety').value.toLowerCase(),
            region: document.getElementById('region').value,
            quality: document.getElementById('quality').value,
            season: document.getElementById('season').value,
            irrigation: document.getElementById('irrigation').value,
            areaMin: parseInt(document.getElementById('areaMin').value),
            areaMax: parseInt(document.getElementById('areaMax').value),
            productivityMin: parseInt(document.getElementById('productivityMin').value),
            productivityMax: parseInt(document.getElementById('productivityMax').value)
        });
        
        // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        worker.onmessage = (e) => {
            this.state.data.filteredResults = e.data.filteredResults;
            this.hideLoading();
            this.displayResults(this.state.data.filteredResults);
            worker.terminate();
        };
    }
    
    // ======== Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ========
    displayResults(results) {
        const resultsGrid = document.getElementById('resultsGrid');
        const resultsCount = document.getElementById('resultsCount');
        const emptyState = document.getElementById('emptyState');
        
        if (results.length === 0) {
            this.showEmptyState();
            return;
        }
        
        this.hideEmptyState();
        
        // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        results.sort((a, b) => {
            switch(this.state.ui.currentSort) {
                case 'area':
                    return b.area - a.area;
                case 'productivity':
                    return b.productivity - a.productivity;
                case 'name':
                    return a.variety.localeCompare(b.variety, 'ar');
                default:
                    return 0;
            }
        });
        
        resultsCount.textContent = `Ø¹Ø±Ø¶ ${results.length} Ù†ØªÙŠØ¬Ø©`;
        
        // Ø§Ø³ØªØ®Ø¯Ø§Ù… DocumentFragment Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
        const fragment = document.createDocumentFragment();
        
        results.forEach(mango => {
            const card = this.createResultCard(mango);
            fragment.appendChild(card);
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø©
        resultsGrid.innerHTML = '';
        resultsGrid.appendChild(fragment);
        
        // ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ©
        this.applyCardAnimations();
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ù†ØªÙŠØ¬Ø© ========
    createResultCard(mango) {
        const card = document.createElement('div');
        card.className = 'result-card ripple-effect';
        card.addEventListener('click', (e) => this.createRipple(e, card));
        
        card.innerHTML = `
            <div class="card-header">
                <div class="mango-info">
                    <h3 class="mango-variety">${mango.variety}</h3>
                    <p class="mango-scientific-name">${mango.scientificName}</p>
                </div>
                <span class="quality-badge quality-${this.getQualityClass(mango.quality)}">${mango.quality}</span>
            </div>
            <div class="card-content">
                <div class="location-section">
                    <h4 class="location-title">
                        <i class="fas fa-map-marker-alt"></i>
                        Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
                    </h4>
                    <div class="location-details">
                        <div class="location-item">
                            <span class="location-label">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©:</span>
                            <span class="location-value">${mango.governorate}</span>
                        </div>
                        <div class="location-item">
                            <span class="location-label">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</span>
                            <span class="location-value">${mango.city}</span>
                        </div>
                        <div class="location-item">
                            <span class="location-label">Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</span>
                            <span class="location-value area-highlight">${mango.area} ÙØ¯Ø§Ù†</span>
                        </div>
                        <div class="location-item">
                            <span class="location-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø±ÙŠ:</span>
                            <span class="location-value">${mango.irrigation}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">${mango.productivity}</div>
                        <div class="stat-label">Ø·Ù†/ÙØ¯Ø§Ù†</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${mango.averageWeight}</div>
                        <div class="stat-label">Ø¬Ø±Ø§Ù…/Ø«Ù…Ø±Ø©</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">${mango.sugarContent}%</div>
                        <div class="stat-label">Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø³ÙƒØ±</div>
                    </div>
                </div>
                <div class="characteristics">
                    <h5 class="characteristics-title">Ø®ØµØ§Ø¦Øµ Ù…Ù…ÙŠØ²Ø©</h5>
                    <div class="characteristics-tags">
                        ${mango.characteristics.map(char => `<span class="characteristic-tag">${char}</span>`).join('')}
                    </div>
                </div>
            </div>
        `;
        
        return card;
    }
    
    // ======== ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ========
    applyCardAnimations() {
        const cards = document.querySelectorAll('.result-card');
        
        cards.forEach((card, index) => {
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¸Ù‡ÙˆØ± ØªØ¯Ø±ÙŠØ¬ÙŠ
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 100);
        });
    }
    
    // ======== Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙØ¦Ø© Ø§Ù„Ø¬ÙˆØ¯Ø© ========
    getQualityClass(quality) {
        const qualityMap = {
            'Ù…Ù…ØªØ§Ø²': 'excellent',
            'ØªØµØ¯ÙŠØ±': 'premium',
            'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹': 'good',
            'Ø¬ÙŠØ¯': 'good'
        };
        return qualityMap[quality] || 'good';
    }
    
    // ======== Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ ========
    showLoading(show) {
        const loadingContainer = document.getElementById('loadingContainer');
        const resultsGrid = document.getElementById('resultsGrid');
        const emptyState = document.getElementById('emptyState');
        
        if (show) {
            loadingContainer.style.display = 'block';
            resultsGrid.style.display = 'none';
            emptyState.style.display = 'none';
        } else {
            loadingContainer.style.display = 'none';
            resultsGrid.style.display = 'grid';
        }
    }
    
    // ======== Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© ÙØ§Ø±ØºØ© ========
    showEmptyState() {
        const emptyState = document.getElementById('emptyState');
        const resultsGrid = document.getElementById('resultsGrid');
        const resultsCount = document.getElementById('resultsCount');
        
        emptyState.style.display = 'block';
        resultsGrid.style.display = 'none';
        resultsCount.textContent = 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬';
    }
    
    // ======== Ø¥Ø®ÙØ§Ø¡ Ø­Ø§Ù„Ø© ÙØ§Ø±ØºØ© ========
    hideEmptyState() {
        const emptyState = document.getElementById('emptyState');
        emptyState.style.display = 'none';
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù…ÙˆØ¬Ø© ========
    createRipple(event, element) {
        const ripple = document.createElement('div');
        ripple.classList.add('ripple');
        
        const rect = element.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        const x = event.clientX - rect.left - size / 2;
        const y = event.clientY - rect.top - size / 2;
        
        ripple.style.width = ripple.style.height = size + 'px';
        ripple.style.left = x + 'px';
        ripple.style.top = y + 'px';
        
        element.appendChild(ripple);
        
        setTimeout(() => {
            ripple.remove();
        }, 600);
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ… Ø§Ù„Ù€ sliders ========
    updateSliderValues() {
        document.getElementById('areaMinValue').textContent = document.getElementById('areaMin').value;
        document.getElementById('areaMaxValue').textContent = document.getElementById('areaMax').value;
        document.getElementById('productivityMinValue').textContent = document.getElementById('productivityMin').value;
        document.getElementById('productivityMaxValue').textContent = document.getElementById('productivityMax').value;
    }
    
    // ======== Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¹Ø§Ù… ========
    showLoader(show) {
        const loader = document.getElementById('globalLoading');
        if (loader) {
            loader.style.display = show ? 'flex' : 'none';
        }
    }
    
    // ======== Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« ========
    showUpdateIndicator(show) {
        const indicator = document.getElementById('updateIndicator');
        if (indicator) {
            indicator.style.display = show ? 'block' : 'none';
        }
    }
    
    // ======== Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹ ========
    saveDataLocally() {
        try {
            const dataToSave = {
                ...this.state.data,
                lastUpdate: this.state.ui.lastUpdate
            };
            
            localStorage.setItem('mangoTrackingData', JSON.stringify(dataToSave));
            console.log('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹');
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹:', error);
        }
    }
    
    // ======== Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ========
    saveAppState() {
        const appState = {
            ui: this.state.ui,
            config: this.config
        };
        
        localStorage.setItem('mangoTrackingAppState', JSON.stringify(appState));
    }
    
    // ======== ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ========
    loadAppState() {
        try {
            const savedState = localStorage.getItem('mangoTrackingAppState');
            if (savedState) {
                const parsedState = JSON.parse(savedState);
                this.state.ui = { ...this.state.ui, ...parsedState.ui };
                this.config = { ...this.config, ...parsedState.config };
            }
        } catch (error) {
            console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:', error);
        }
    }
    
    // ======== Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± ========
    showNotification(message, type = 'info') {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
            <div class="notification-content">
                <span>${message}</span>
                <button class="notification-close">&times;</button>
            </div>
        `;
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„ØµÙØ­Ø©
        document.body.appendChild(notification);
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¹ ØªØ£Ø«ÙŠØ± Ø­Ø±ÙƒÙŠ
        setTimeout(() => {
            notification.style.transform = 'translateX(0)';
            notification.style.opacity = '1';
        }, 10);
        
        // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ ÙØªØ±Ø©
        const autoRemove = setTimeout(() => {
            this.removeNotification(notification);
        }, 5000);
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
        notification.querySelector('.notification-close').addEventListener('click', () => {
            clearTimeout(autoRemove);
            this.removeNotification(notification);
        });
    }
    
    // ======== Ø¥Ø²Ø§Ù„Ø© Ø¥Ø´Ø¹Ø§Ø± ========
    removeNotification(notification) {
        notification.style.transform = 'translateX(100%)';
        notification.style.opacity = '0';
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }
    
    // ======== Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ ========
    showError(message) {
        this.showNotification(message, 'error');
    }
    
    // ======== Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© ========
    createModal(title, content) {
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.innerHTML = `
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">${title}</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    ${content}
                </div>
            </div>
        `;
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
        modal.querySelector('.modal-close').addEventListener('click', () => {
            modal.remove();
        });
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.remove();
            }
        });
        
        return modal;
    }
    
    // ======== ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ù‚ÙŠÙ… ========
    animateValue(id, start, end, duration, isK = false) {
        const element = document.getElementById(id);
        if (!element) return;
        
        const range = end - start;
        const increment = range / (duration / 16);
        let current = start;
        
        const timer = setInterval(() => {
            current += increment;
            
            if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
                current = end;
                clearInterval(timer);
            }
            
            element.textContent = isK ? 
                Math.floor(current).toLocaleString() : 
                Math.floor(current);
        }, 16);
    }
    
    // ======== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ø§Ø¹Ø© ========
    updateClock() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('ar-EG', {
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });
        
        const clockElement = document.getElementById('clock');
        if (clockElement) {
            clockElement.textContent = timeString;
        }
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØªÙ…Ø±ÙŠØ± ========
    setupScrollEffects() {
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ±
        let lastScrollTop = 0;
        const header = document.querySelector('.header');
        
        window.addEventListener('scroll', () => {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > lastScrollTop && scrollTop > 100) {
                header.style.transform = 'translateY(-100%)';
            } else {
                header.style.transform = 'translateY(0)';
            }
            
            lastScrollTop = scrollTop;
        });
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ± Ø¹Ù†Ø¯ Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø¹Ù†Ø§ØµØ±
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -100px 0px'
        };
        
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('scroll-visible');
                }
            });
        }, observerOptions);
        
        document.querySelectorAll('.card').forEach(card => {
            observer.observe(card);
        });
    }
    
    // ======== Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø­Ø±ÙƒØ© ========
    setupAnimationEffects() {
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©
        this.animateBackground();
        
        // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ù‡Ù…Ø©
        document.querySelectorAll('.animate-pulse').forEach(element => {
            element.style.animation = 'pulse 2s infinite';
        });
    }
    
    // ======== ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø®Ù„ÙÙŠØ© ========
    animateBackground() {
        const body = document.body;
        let position = 0;
        
        const animate = () => {
            position += 0.1;
            body.style.backgroundPosition = `${position}px ${position}px`;
            requestAnimationFrame(animate);
        };
        
        animate();
    }
    
    // ======== Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© ========
    debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }
    
    throttle(func, limit) {
        let inThrottle;
        return function() {
            const args = arguments;
            const context = this;
            if (!inThrottle) {
                func.apply(context, args);
                inThrottle = true;
                setTimeout(() => inThrottle = false, limit);
            }
        };
    }
    
    // ======== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø®Ø±ÙŠØ·Ø© ========
    getCurrentLocation() {
        if (!navigator.geolocation) {
            this.showNotification('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
            return;
        }
        
        navigator.geolocation.getCurrentPosition(
            (position) => {
                const { latitude, longitude } = position.coords;
                this.state.map.setView([latitude, longitude], 13);
                L.marker([latitude, longitude])
                    .addTo(this.state.map)
                    .bindPopup('ğŸ“ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ')
                    .openPopup();
            },
            () => {
                this.showNotification('ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
            }
        );
    }
    
    addMangoFarms() {
        const farms = [
            { lat: 30.65, lon: 30.90, name: "Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø¨Ø­ÙŠØ±Ø©" },
            { lat: 30.95, lon: 31.15, name: "Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø¬ÙŠØ²Ø©" },
            { lat: 30.30, lon: 31.25, name: "Ù…Ø²Ø±Ø¹Ø© Ø§Ù„Ø´Ø±Ù‚ÙŠØ©" }
        ];
        
        farms.forEach(farm => {
            L.marker([farm.lat, farm.lon], { icon: this.farmIcon })
                .addTo(this.state.map)
                .bindPopup(`<strong>${farm.name}</strong>`);
        });
    }
    
    showMarkets() {
        const markets = [
            { lat: 30.0444, lon: 31.2357, name: "Ø³ÙˆÙ‚ Ø§Ù„Ø¹Ø¨ÙˆØ±" },
            { lat: 30.1200, lon: 31.3200, name: "Ø³ÙˆÙ‚ 6 Ø£ÙƒØªÙˆØ¨Ø±" }
        ];
        
        markets.forEach(market => {
            L.marker([market.lat, market.lon], { icon: this.marketIcon })
                .addTo(this.state.map)
                .bindPopup(`<strong>${market.name}</strong>`);
        });
    }
    
    clearMap() {
        this.state.map.eachLayer(layer => {
            if (layer instanceof L.Marker || layer instanceof L.Circle) {
                this.state.map.removeLayer(layer);
            }
        });
    }
    
    searchLocation(query) {
        if (!query) {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙˆÙ‚Ø¹ Ù„Ù„Ø¨Ø­Ø«', 'warning');
            return;
        }
        
        fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}`)
            .then(res => res.json())
            .then(data => {
                if (data.length > 0) {
                    const { lat, lon, display_name } = data[0];
                    this.state.map.setView([lat, lon], 13);
                    L.marker([lat, lon])
                        .addTo(this.state.map)
                        .bindPopup(`<strong>${display_name}</strong>`)
                        .openPopup();
                } else {
                    this.showNotification('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'warning');
                }
            })
            .catch(error => {
                console.error('Search error:', error);
                this.showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø«', 'error');
            });
    }
    
    // ======== Ø¯Ø¹Ù… ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ========
    showForecast(period) {
        const data = this.state.data.forecasts[period];
        if (!data) return;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        document.querySelectorAll('.forecast-section .btn').forEach(btn => {
            btn.classList.remove('active');
        });
        event.target.classList.add('active');
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        document.getElementById('forecastPrice').textContent = `${data.price.toFixed(1)} Ø¬Ù†ÙŠÙ‡/ÙƒØ¬Ù…`;
        document.getElementById('forecastConfidence').textContent = `${data.confidence}%`;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
        const ctx = document.getElementById('forecastChart').getContext('2d');
        
        if (this.state.charts.forecastChart) {
            this.state.charts.forecastChart.destroy();
        }
        
        this.state.charts.forecastChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: data.labels,
                datasets: [{
                    label: 'Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…ØªÙˆÙ‚Ø¹',
                    data: data.values,
                    borderColor: '#f39c12',
                    backgroundColor: 'rgba(243, 156, 18, 0.2)',
                    fill: true,
                    tension: 0.4,
                    pointBackgroundColor: '#e67e22',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointRadius: 6,
                    pointHoverRadius: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Ø¬Ù†ÙŠÙ‡/ÙƒÙŠÙ„Ùˆ',
                            color: '#e2e8f0'
                        },
                        ticks: {
                            color: '#e2e8f0'
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    },
                    x: {
                        ticks: {
                            color: '#e2e8f0'
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleFont: {
                            family: 'Cairo, sans-serif',
                            size: 14
                        },
                        bodyFont: {
                            family: 'Cairo, sans-serif',
                            size: 13
                        },
                        padding: 12,
                        cornerRadius: 8
                    }
                }
            }
        });
    }
    
    // ======== Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ ========
    getMangoDatabase() {
        return [
            {
                id: 1,
                variety: 'ÙƒÙŠØª',
                scientificName: 'Mangifera indica var. Keitt',
                region: 'Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©',
                area: 850,
                quality: 'Ù…Ù…ØªØ§Ø²',
                productivity: 18.5,
                season: 'Ù…ØªØ£Ø®Ø±',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø§Ù„Ø¥Ø³Ù…Ø§Ø¹ÙŠÙ„ÙŠØ©',
                city: 'Ø£Ø¨Ùˆ ØµÙˆÙŠØ±',
                characteristics: ['Ø­Ø¬Ù… ÙƒØ¨ÙŠØ±', 'Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø£Ù…Ø±Ø§Ø¶', 'ØµØ§Ù„Ø­ Ù„Ù„ØªØµØ¯ÙŠØ±', 'Ù†ÙƒÙ‡Ø© Ù…Ù…ÙŠØ²Ø©'],
                averageWeight: 450,
                sugarContent: 16.8,
                shelfLife: 21
            },
            {
                id: 2,
                variety: 'Ø¹ÙˆÙŠØ³',
                scientificName: 'Mangifera indica var. Ewais',
                region: 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©',
                area: 1200,
                quality: 'Ù…Ù…ØªØ§Ø²',
                productivity: 22.3,
                season: 'Ù…Ø¨ÙƒØ±',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø§Ù„Ø´Ø±Ù‚ÙŠØ©',
                city: 'Ø§Ù„Ø²Ù‚Ø§Ø²ÙŠÙ‚',
                characteristics: ['Ø­Ù„Ø§ÙˆØ© Ø¹Ø§Ù„ÙŠØ©', 'Ù„ÙˆÙ† Ø¬Ø°Ø§Ø¨', 'Ù…Ø¨ÙƒØ± Ø§Ù„Ù†Ø¶Ø¬', 'Ù…Ø­Ø¨ÙˆØ¨ Ù…Ø­Ù„ÙŠØ§Ù‹'],
                averageWeight: 280,
                sugarContent: 19.2,
                shelfLife: 14
            },
            {
                id: 3,
                variety: 'Ø²Ø¨Ø¯ÙŠØ©',
                scientificName: 'Mangifera indica var. Zebdia',
                region: 'Ø§Ù„Ø¨Ø­ÙŠØ±Ø©',
                area: 950,
                quality: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹',
                productivity: 16.8,
                season: 'Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…',
                irrigation: 'Ø±Ø´',
                governorate: 'Ø§Ù„Ø¨Ø­ÙŠØ±Ø©',
                city: 'Ø§Ù„Ù†ÙˆØ¨Ø§Ø±ÙŠØ©',
                characteristics: ['Ù‚ÙˆØ§Ù… ÙƒØ±ÙŠÙ…ÙŠ', 'Ø·Ø¹Ù… Ø­Ù„Ùˆ', 'Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„Ù†Ù‚Ù„', 'ØªØ®Ø²ÙŠÙ† Ø¬ÙŠØ¯'],
                averageWeight: 320,
                sugarContent: 17.5,
                shelfLife: 18
            },
            {
                id: 4,
                variety: 'Ø³ÙƒØ±ÙŠ',
                scientificName: 'Mangifera indica var. Succary',
                region: 'Ø§Ù„Ø¬ÙŠØ²Ø©',
                area: 650,
                quality: 'ØªØµØ¯ÙŠØ±',
                productivity: 20.1,
                season: 'Ù…Ø¨ÙƒØ±',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø§Ù„Ø¬ÙŠØ²Ø©',
                city: 'Ø§Ù„Ø¹ÙŠØ§Ø·',
                characteristics: ['Ø³ÙƒØ±ÙŠØ§Øª Ø¹Ø§Ù„ÙŠØ©', 'Ù„ÙˆÙ† Ø°Ù‡Ø¨ÙŠ', 'Ø±Ø§Ø¦Ø­Ø© Ø¹Ø·Ø±Ø©', 'Ø¬ÙˆØ¯Ø© ØªØµØ¯ÙŠØ±'],
                averageWeight: 380,
                sugarContent: 21.3,
                shelfLife: 16
            },
            {
                id: 5,
                variety: 'Ù‡Ù†Ø¯ÙŠ',
                scientificName: 'Mangifera indica var. Hindi',
                region: 'Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©',
                area: 420,
                quality: 'Ø¬ÙŠØ¯',
                productivity: 14.7,
                season: 'Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…',
                irrigation: 'ØºÙ…Ø±',
                governorate: 'Ø§Ù„Ù‚Ù„ÙŠÙˆØ¨ÙŠØ©',
                city: 'Ø´Ø¨Ø±Ø§ Ø§Ù„Ø®ÙŠÙ…Ø©',
                characteristics: ['Ø­Ø¬Ù… Ù…ØªÙˆØ³Ø·', 'Ø·Ø¹Ù… ØªÙ‚Ù„ÙŠØ¯ÙŠ', 'Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¹ØµØ§Ø¦Ø±', 'Ø³Ø¹Ø± Ø§Ù‚ØªØµØ§Ø¯ÙŠ'],
                averageWeight: 250,
                sugarContent: 15.8,
                shelfLife: 12
            },
            {
                id: 6,
                variety: 'ØªÙˆÙ…ÙŠ Ø£ØªÙƒÙŠÙ†Ø²',
                scientificName: 'Mangifera indica var. Tommy Atkins',
                region: 'Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©',
                area: 780,
                quality: 'ØªØµØ¯ÙŠØ±',
                productivity: 19.4,
                season: 'Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø§Ù„Ù…Ù†ÙˆÙÙŠØ©',
                city: 'Ø´Ø¨ÙŠÙ† Ø§Ù„ÙƒÙˆÙ…',
                characteristics: ['Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø´Ø­Ù†', 'Ø´ÙƒÙ„ Ø¬Ø°Ø§Ø¨', 'Ù„ÙˆÙ† Ø£Ø­Ù…Ø±', 'Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„Ù…ÙŠØ©'],
                averageWeight: 420,
                sugarContent: 16.2,
                shelfLife: 25
            },
            {
                id: 7,
                variety: 'ÙƒÙ†Øª',
                scientificName: 'Mangifera indica var. Kent',
                region: 'ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®',
                area: 320,
                quality: 'Ù…Ù…ØªØ§Ø²',
                productivity: 17.9,
                season: 'Ù…ØªØ£Ø®Ø±',
                irrigation: 'Ø±Ø´',
                governorate: 'ÙƒÙØ± Ø§Ù„Ø´ÙŠØ®',
                city: 'Ø¯Ø³ÙˆÙ‚',
                characteristics: ['Ø­Ø¬Ù… ÙƒØ¨ÙŠØ±', 'Ù‚Ù„ÙŠÙ„ Ø§Ù„Ø£Ù„ÙŠØ§Ù', 'Ø·Ø¹Ù… Ø­Ù„Ùˆ', 'Ù†Ø¶Ø¬ Ù…ØªØ£Ø®Ø±'],
                averageWeight: 480,
                sugarContent: 18.1,
                shelfLife: 19
            },
            {
                id: 8,
                variety: 'Ù‡Ø§ÙŠØ¯Ù†',
                scientificName: 'Mangifera indica var. Haden',
                region: 'Ø§Ù„ØºØ±Ø¨ÙŠØ©',
                area: 290,
                quality: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹',
                productivity: 15.6,
                season: 'Ù…Ø¨ÙƒØ±',
                irrigation: 'Ù…Ø­ÙˆØ±ÙŠ',
                governorate: 'Ø§Ù„ØºØ±Ø¨ÙŠØ©',
                city: 'Ø·Ù†Ø·Ø§',
                characteristics: ['Ù„ÙˆÙ† Ø£Ø­Ù…Ø± ÙˆØ±Ø¯ÙŠ', 'Ø¹Ø·Ø± Ù‚ÙˆÙŠ', 'Ø·Ø¹Ù… Ù…Ù…ÙŠØ²', 'ØªØ§Ø±ÙŠØ® Ø¹Ø±ÙŠÙ‚'],
                averageWeight: 350,
                sugarContent: 17.8,
                shelfLife: 15
            },
            {
                id: 9,
                variety: 'ÙÙˆÙ†Ø³Ùˆ',
                scientificName: 'Mangifera indica var. Alphonso',
                region: 'Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©',
                area: 180,
                quality: 'Ù…Ù…ØªØ§Ø²',
                productivity: 16.3,
                season: 'Ù…Ø¨ÙƒØ±',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø§Ù„Ø¯Ù‚Ù‡Ù„ÙŠØ©',
                city: 'Ø§Ù„Ù…Ù†ØµÙˆØ±Ø©',
                characteristics: ['Ù…Ù„Ùƒ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ', 'Ø·Ø¹Ù… Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠ', 'Ù„Ø¨ ÙƒØ«ÙŠÙ', 'Ø¬ÙˆØ¯Ø© ÙØ§Ø¦Ù‚Ø©'],
                averageWeight: 300,
                sugarContent: 20.5,
                shelfLife: 14
            },
            {
                id: 10,
                variety: 'Ø¨Ø§Ù„Ù…Ø±',
                scientificName: 'Mangifera indica var. Palmer',
                region: 'Ø¯Ù…ÙŠØ§Ø·',
                area: 210,
                quality: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹',
                productivity: 18.8,
                season: 'Ù…Ù†ØªØµÙ Ø§Ù„Ù…ÙˆØ³Ù…',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø¯Ù…ÙŠØ§Ø·',
                city: 'Ø±Ø£Ø³ Ø§Ù„Ø¨Ø±',
                characteristics: ['Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø±Ø·ÙˆØ¨Ø©', 'Ø¥Ù†ØªØ§Ø¬ÙŠØ© Ø¹Ø§Ù„ÙŠØ©', 'ØªÙƒÙŠÙ Ø³Ø§Ø­Ù„ÙŠ', 'Ù†ÙƒÙ‡Ø© Ù…ØªÙˆØ§Ø²Ù†Ø©'],
                averageWeight: 380,
                sugarContent: 16.9,
                shelfLife: 17
            },
            {
                id: 11,
                variety: 'Ø¬Ù„ÙŠÙ†',
                scientificName: 'Mangifera indica var. Glenn',
                region: 'Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡',
                area: 150,
                quality: 'Ø¬ÙŠØ¯',
                productivity: 12.4,
                season: 'Ù…ØªØ£Ø®Ø±',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡',
                city: 'Ø§Ù„Ø¹Ø±ÙŠØ´',
                characteristics: ['Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø¬ÙØ§Ù', 'Ù…ØªÙƒÙŠÙ ØµØ­Ø±Ø§ÙˆÙŠ', 'Ø­Ø¬Ù… ØµØºÙŠØ±', 'Ø·Ø¹Ù… Ù…Ø±ÙƒØ²'],
                averageWeight: 200,
                sugarContent: 18.7,
                shelfLife: 13
            },
            {
                id: 12,
                variety: 'ÙƒÙŠÙˆ',
                scientificName: 'Mangifera indica var. Keo',
                region: 'Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡',
                area: 85,
                quality: 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹',
                productivity: 11.8,
                season: 'Ù…ØªØ£Ø®Ø±',
                irrigation: 'ØªÙ†Ù‚ÙŠØ·',
                governorate: 'Ø¬Ù†ÙˆØ¨ Ø³ÙŠÙ†Ø§Ø¡',
                city: 'Ø·ÙˆØ± Ø³ÙŠÙ†Ø§Ø¡',
                characteristics: ['ØªØ­Ù…Ù„ Ø§Ù„Ù…Ù„ÙˆØ­Ø©', 'Ø²Ø±Ø§Ø¹Ø© Ø¹Ø¶ÙˆÙŠØ©', 'Ø­Ø¬Ù… Ù…ØªÙˆØ³Ø·', 'Ø¬ÙˆØ¯Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©'],
                averageWeight: 270,
                sugarContent: 17.2,
                shelfLife: 16
            }
        ];
    }
}

// ======== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ========
document.addEventListener('DOMContentLoaded', () => {
    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    window.app = new MangoTrackingApp();
    
    // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø§Ù…Ø© Ù…ØªØ§Ø­Ø©
    window.updateAllData = () => window.app.updateAllData();
    window.exportData = () => window.app.exportData();
    window.showAnalytics = () => window.app.showAnalytics();
    window.generateReport = () => window.app.generateReport();
    window.showSettings = () => window.app.showSettings();
    window.getCurrentLocation = () => window.app.getCurrentLocation();
    window.addMangoFarms = () => window.app.addMangoFarms();
    window.showMarkets = () => window.app.showMarkets();
    window.clearMap = () => window.app.clearMap();
    window.searchLocation = () => window.app.searchLocation(document.getElementById('searchLocation').value);
    window.showForecast = (period) => window.app.showForecast(period);
    window.saveSettings = () => window.app.saveSettings();
    window.closeModal = () => window.app.closeModal();
});

// ======== Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· CSS Ù„Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© ========
const dynamicStyles = document.createElement('style');
dynamicStyles.textContent = `
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
    .notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        transform: translateX(120%);
        transition: transform 0.3s ease, opacity 0.3s ease;
        opacity: 0;
        max-width: 300px;
    }
    
    .notification-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px;
    }
    
    .notification-close {
        background: none;
        border: none;
        font-size: 18px;
        cursor: pointer;
        color: #666;
        margin-right: 10px;
    }
    
    .notification-info {
        border-right: 4px solid #3498db;
    }
    
    .notification-success {
        border-right: 4px solid #2ecc71;
    }
    
    .notification-warning {
        border-right: 4px solid #f39c12;
    }
    
    .notification-error {
        border-right: 4px solid #e74c3c;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
    .modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .modal.show {
        opacity: 1;
    }
    
    .modal-content {
        background: var(--card-bg);
        backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        width: 90%;
        max-width: 800px;
        max-height: 90vh;
        overflow-y: auto;
        transform: scale(0.9);
        transition: transform 0.3s ease;
    }
    
    .modal.show .modal-content {
        transform: scale(1);
    }
    
    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px;
        border-bottom: 1px solid var(--glass-border);
    }
    
    .modal-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-primary);
    }
    
    .modal-close {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--text-secondary);
        transition: color 0.3s ease;
    }
    
    .modal-close:hover {
        color: var(--text-primary);
    }
    
    .modal-body {
        padding: 20px;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    .scroll-visible {
        opacity: 1 !important;
        transform: translateY(0) !important;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ø§Ø¹Ø© */
    #clock {
        font-weight: 600;
        color: var(--text-accent);
    }
`;

document.head.appendChild(dynamicStyles);


</script>





    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        let map = L.map('map').setView([30.4, 30.8], 9);
        let currentLayer = null;
        let markers = [];
        let overlays = {};
        let mangoFarms = [];
        let markets = [];

        // Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†Ø§Ø·Ù‚ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
        const mangoRegions = [
            {
                id: 'sphinx_mango',
                name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ - Ø³ÙÙ†ÙƒØ³',
                location: { lat: 29.9753, lng: 31.1376 },
                area: 420,
                production: 2100,
                farms: 28,
                varieties: ['ÙƒÙŠØª', 'ÙƒÙ†Øª', 'Ø¹ÙˆÙŠØ³'],
                status: 'Ù…Ù…ØªØ§Ø²',
                yield: 5.0,
                irrigationType: 'ØªÙ†Ù‚ÙŠØ·'
            },
            {
                id: 'abu_ghalib_mango',
                name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ - Ø£Ø¨Ùˆ ØºØ§Ù„Ø¨',
                location: { lat: 30.1200, lng: 30.9500 },
                area: 680,
                production: 3740,
                farms: 42,
                varieties: ['Ø²Ø¨Ø¯Ø©', 'ÙÙˆÙ†Ø³', 'ÙƒÙŠØª'],
                status: 'Ù…Ù…ØªØ§Ø²',
                yield: 5.5,
                irrigationType: 'ØªÙ†Ù‚ÙŠØ·'
            },
            {
                id: 'khatatba_mango',
                name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ - Ø§Ù„Ø®Ø·Ø§Ø·Ø¨Ø©',
                location: { lat: 30.2650, lng: 30.7800 },
                area: 520,
                production: 2600,
                farms: 35,
                varieties: ['Ø¹ÙˆÙŠØ³', 'Ø³ÙƒØ±ÙŠ', 'ÙƒÙ†Øª'],
                status: 'Ø¬ÙŠØ¯',
                yield: 5.0,
                irrigationType: 'Ø±Ø´ ÙˆÙ…Ø­ÙˆØ±ÙŠ'
            },
            {
                id: 'sadat_mango',
                name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ - Ø§Ù„Ø³Ø§Ø¯Ø§Øª',
                location: { lat: 30.3708, lng: 30.6042 },
                area: 890,
                production: 5340,
                farms: 56,
                varieties: ['ÙƒÙŠØª', 'ØªÙˆÙ…ÙŠ Ø£ØªÙƒÙ†Ø²', 'ÙƒÙ†Øª'],
                status: 'Ù…Ù…ØªØ§Ø²',
                yield: 6.0,
                irrigationType: 'ØªÙ†Ù‚ÙŠØ·'
            },
            {
                id: 'wadi_natrun_mango',
                name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ - ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù†Ø·Ø±ÙˆÙ†',
                location: { lat: 30.3828, lng: 30.3467 },
                area: 750,
                production: 4125,
                farms: 48,
                varieties: ['Ø²Ø¨Ø¯Ø©', 'Ø¹ÙˆÙŠØ³', 'ÙÙˆÙ†Ø³'],
                status: 'Ù…Ù…ØªØ§Ø²',
                yield: 5.5,
                irrigationType: 'ØªÙ†Ù‚ÙŠØ·'
            },
            {
                id: 'naburiya_mango',
                name: 'Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ - Ø§Ù„Ù†Ø§Ø¨ÙˆØ±ÙŠØ©',
                location: { lat: 30.4200, lng: 30.1800 },
                area: 387,
                production: 1935,
                farms: 23,
                varieties: ['ÙƒÙŠØª', 'Ø³ÙƒØ±ÙŠ', 'ÙƒÙ†Øª'],
                status: 'Ø¬ÙŠØ¯',
                yield: 5.0,
                irrigationType: 'Ø±Ø´'
            }
        ];

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³ÙˆØ§Ù‚ ÙˆÙ…Ø±Ø§ÙƒØ² Ø§Ù„ØªØ³ÙˆÙŠÙ‚
        const marketCenters = [
            {
                name: 'Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù…Ù„Ø© - Ø§Ù„Ø³Ø§Ø¯Ø§Øª',
                location: { lat: 30.3708, lng: 30.6142 },
                type: 'Ø³ÙˆÙ‚ Ø¬Ù…Ù„Ø©',
                capacity: '500 Ø·Ù†/ÙŠÙˆÙ…'
            },
            {
                name: 'Ù…Ø±ÙƒØ² ØªØ¬Ù…ÙŠØ¹ ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù†Ø·Ø±ÙˆÙ†',
                location: { lat: 30.3828, lng: 30.3567 },
                type: 'Ù…Ø±ÙƒØ² ØªØ¬Ù…ÙŠØ¹',
                capacity: '200 Ø·Ù†/ÙŠÙˆÙ…'
            },
            {
                name: 'Ø³ÙˆÙ‚ Ø§Ù„Ø®Ø·Ø§Ø·Ø¨Ø© Ø§Ù„Ù…Ø­Ù„ÙŠ',
                location: { lat: 30.2650, lng: 30.7900 },
                type: 'Ø³ÙˆÙ‚ Ù…Ø­Ù„ÙŠ',
                capacity: '100 Ø·Ù†/ÙŠÙˆÙ…'
            }
        ];

        // Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ø®ØªÙ„ÙØ©
        const baseLayers = {
            satellite: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Esri WorldImagery',
                maxZoom: 18
            }),
            hybrid: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Esri WorldImagery',
                maxZoom: 18
            }),
            terrain: L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}', {
                attribution: 'Esri WorldPhysical',
                maxZoom: 18
            }),
            osm: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap',
                maxZoom: 18
            })
        };

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        currentLayer = baseLayers.satellite;
        currentLayer.addTo(map);

        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø§Øª Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
        function addMangoFarms() {
            clearMarkers();
            
            mangoRegions.forEach(region => {
                const mangoIcon = L.divIcon({
                    html: '<i class="fas fa-seedling" style="color: #fb923c; font-size: 20px;"></i>',
                    iconSize: [30, 30],
                    className: 'mango-marker'
                });

                const marker = L.marker([region.location.lat, region.location.lng], { icon: mangoIcon })
                    .bindPopup(createMangoPopup(region))
                    .addTo(map);
                
                markers.push(marker);

                // Ø¥Ø¶Ø§ÙØ© Ø¯Ø§Ø¦Ø±Ø© Ù„ØªÙˆØ¶ÙŠØ­ Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©
                const circle = L.circle([region.location.lat, region.location.lng], {
                    color: '#fb923c',
                    fillColor: '#fb923c',
                    fillOpacity: 0.2,
                    radius: Math.sqrt(region.area) * 100
                }).addTo(map);
                
                markers.push(circle);
            });

            updateRegionsGrid();
        }

        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø£Ø³ÙˆØ§Ù‚
        function showMarkets() {
            marketCenters.forEach(market => {
                const marketIcon = L.divIcon({
                    html: '<i class="fas fa-store" style="color: #8b5cf6; font-size: 18px;"></i>',
                    iconSize: [25, 25],
                    className: 'market-marker'
                });

                const marker = L.marker([market.location.lat, market.location.lng], { icon: marketIcon })
                    .bindPopup(createMarketPopup(market))
                    .addTo(map);
                
                markers.push(marker);
            });
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
        function createMangoPopup(region) {
            return `
                <div class="custom-popup">
                    <div class="popup-title">
                        <i class="fas fa-seedling"></i>
                        ${region.name}
                    </div>
                    <div class="popup-content">
                        <div class="popup-detail">
                            <strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong> 
                            <span class="popup-highlight">${region.area} ÙØ¯Ø§Ù†</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ø§Ù„Ø¥Ù†ØªØ§Ø¬:</strong> 
                            <span class="popup-highlight">${region.production} Ø·Ù†</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹:</strong> 
                            <span class="popup-highlight">${region.farms} Ù…Ø²Ø±Ø¹Ø©</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©:</strong> 
                            <span class="popup-highlight">${region.yield} Ø·Ù†/ÙØ¯Ø§Ù†</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ:</strong> 
                            <span class="popup-highlight">${region.varieties.join(', ')}</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ:</strong> 
                            <span class="popup-highlight">${region.irrigationType}</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬:</strong> 
                            <span class="popup-highlight">${region.status}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù„Ø£Ø³ÙˆØ§Ù‚
        function createMarketPopup(market) {
            return `
                <div class="custom-popup">
                    <div class="popup-title">
                        <i class="fas fa-store"></i>
                        ${market.name}
                    </div>
                    <div class="popup-content">
                        <div class="popup-detail">
                            <strong>Ø§Ù„Ù†ÙˆØ¹:</strong> 
                            <span class="popup-highlight">${market.type}</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ø§Ù„Ø³Ø¹Ø©:</strong> 
                            <span class="popup-highlight">${market.capacity}</span>
                        </div>
                        <div class="popup-detail">
                            <strong>Ù…ÙˆØ³Ù… Ø§Ù„Ø°Ø±ÙˆØ©:</strong> 
                            <span class="popup-highlight">ÙŠÙˆÙ†ÙŠÙˆ - Ø³Ø¨ØªÙ…Ø¨Ø±</span>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ø±Ø³Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
        function drawDesertRoad() {
            const roadCoords = mangoRegions.map(region => [region.location.lat, region.location.lng]);
            
            const road = L.polyline(roadCoords, {
                color: '#ef4444',
                weight: 4,
                opacity: 0.8,
                dashArray: '10, 5'
            }).addTo(map);
            
            road.bindPopup(`
                <div class="custom-popup">
                    <div class="popup-title">
                        <i class="fas fa-road"></i>
                        Ø·Ø±ÙŠÙ‚ Ù…ØµØ± Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ© Ø§Ù„ØµØ­Ø±Ø§ÙˆÙŠ
                    </div>
                    <div class="popup-content">
                        <div class="popup-detail"><strong>Ø§Ù„Ø·ÙˆÙ„:</strong> 156 ÙƒÙŠÙ„ÙˆÙ…ØªØ±</div>
                        <div class="popup-detail"><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> Ù…Ù…ØªØ§Ø²Ø©</div>
                        <div class="popup-detail"><strong>Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ø±Ø§Øª:</strong> 4 Ø­Ø§Ø±Ø§Øª</div>
                        <div class="popup-detail"><strong>Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ:</strong> 184 Ù…Ø²Ø±Ø¹Ø©</div>
                    </div>
                </div>
            `);
        }

        // ØªØ­Ø¯ÙŠØ« Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚
        function updateRegionsGrid() {
            const grid = document.getElementById('regionsGrid');
            grid.innerHTML = '';

            mangoRegions.forEach(region => {
                const productivity = (region.production / region.area).toFixed(1);
                const statusClass = region.status === 'Ù…Ù…ØªØ§Ø²' ? 'status-excellent' : 
                                  region.status === 'Ø¬ÙŠØ¯' ? 'status-good' : 'status-average';
                
                const progressPercentage = Math.min((region.yield / 6.0) * 100, 100);

                const card = document.createElement('div');
                card.className = 'region-card';
                card.innerHTML = `
                    <div class="region-header">
                        <div class="region-title">
                            <i class="fas fa-seedling" style="color: #fb923c;"></i>
                            ${region.name}
                        </div>
                        <div class="region-status ${statusClass}">
                            ${region.status}
                        </div>
                    </div>
                    <div class="region-details">
                        <div class="detail-row">
                            <span class="detail-label">Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</span>
                            <span>${region.area} ÙØ¯Ø§Ù†</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                            <span>${region.production} Ø·Ù†</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹:</span>
                            <span>${region.farms} Ù…Ø²Ø±Ø¹Ø©</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©:</span>
                            <span>${region.yield} Ø·Ù†/ÙØ¯Ø§Ù†</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ:</span>
                            <span>${region.varieties.join(', ')}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ:</span>
                            <span>${region.irrigationType}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${progressPercentage}%"></div>
                        </div>
                        <small style="color: rgba(255,255,255,0.7); margin-top: 5px; display: block;">
                            ÙƒÙØ§Ø¡Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬: ${progressPercentage.toFixed(0)}%
                        </small>
                    </div>
                `;
                
                card.addEventListener('click', () => {
                    map.setView([region.location.lat, region.location.lng], 14);
                });
                
                grid.appendChild(card);
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ù†ÙˆØ¹ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        function updateMapType() {
            const mapType = document.getElementById('mapType').value;
            
            if (currentLayer) {
                map.removeLayer(currentLayer);
            }
            
            currentLayer = baseLayers[mapType];
            currentLayer.addTo(map);
            
            if (mapType === 'hybrid') {
                const roadsLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    opacity: 0.5
                });
                roadsLayer.addTo(map);
            }
        }

        // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª
        function clearMarkers() {
            markers.forEach(marker => {
                map.removeLayer(marker);
            });
            markers = [];
        }

        // Ù…Ø³Ø­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        function clearMap() {
            clearMarkers();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        function updateMap() {
            showLoading();
            
            setTimeout(() => {
                updateMapType();
                const displayOption = document.getElementById('displayOptions').value;
                
                if (displayOption === 'mango_farms' || displayOption === 'all') {
                    addMangoFarms();
                }
                if (displayOption === 'markets' || displayOption === 'all') {
                    showMarkets();
                }
                
                hideLoading();
                updateStats();
            }, 2000);
        }

        // ØªØ­Ù„ÙŠÙ„ Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ
        function analyzeMangoRegion() {
            showLoading();
            
            setTimeout(() => {
                hideLoading();
                updateAnalysisData();
                alert('ØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ù…Ù†Ø§Ø·Ù‚ Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ. ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª.');
            }, 3000);
        }

        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ­Ù„ÙŠÙ„
        function updateAnalysisData() {
            const totalProduction = mangoRegions.reduce((sum, region) => sum + region.production, 0);
            const totalArea = mangoRegions.reduce((sum, region) => sum + region.area, 0);
            const totalFarms = mangoRegions.reduce((sum, region) => sum + region.farms, 0);
            const avgYield = (totalProduction / totalArea).toFixed(1);

            document.getElementById('totalProduction').textContent = totalProduction.toLocaleString();
            document.getElementById('farmArea').textContent = totalArea.toLocaleString();
            document.getElementById('avgYield').textContent = avgYield;
            document.getElementById('farmsCount').textContent = totalFarms;
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹
        function searchLocation() {
            const searchTerm = document.getElementById('searchLocation').value.toLowerCase();
            const foundRegion = mangoRegions.find(region => 
                region.name.toLowerCase().includes(searchTerm)
            );
            
            if (foundRegion) {
                map.setView([foundRegion.location.lat, foundRegion.location.lng], 14);
                
                const marker = markers.find(m => 
                    m.getLatLng && 
                    Math.abs(m.getLatLng().lat - foundRegion.location.lat) < 0.01
                );
                
                if (marker && marker.openPopup) {
                    marker.openPopup();
                }
            } else {
                alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
            }
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
        function getCurrentLocation() {
            if (navigator.geolocation) {
                showLoading();
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        map.setView([lat, lng], 15);
                        
                        const userIcon = L.divIcon({
                            html: '<i class="fas fa-user-location" style="color: #ef4444; font-size: 24px;"></i>',
                            iconSize: [30, 30],
                            className: 'user-marker'
                        });
                        
                        const userMarker = L.marker([lat, lng], { icon: userIcon })
                            .bindPopup('Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ')
                            .addTo(map);
                        
                        markers.push(userMarker);
                        hideLoading();
                    },
                    (error) => {
                        hideLoading();
                        alert('Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ');
                    }
                );
            } else {
                alert('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø®Ø¯Ù…Ø© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            const totalFarms = mangoRegions.reduce((sum, region) => sum + region.farms, 0);
            const accuracy = Math.floor(Math.random() * 5 + 90);
            const activeRegions = mangoRegions.length;
            const marketCentersCount = marketCenters.length;

            document.getElementById('totalMangoFarms').textContent = totalFarms;
            document.getElementById('analysisAccuracy').textContent = accuracy + '%';
            document.getElementById('activeRegions').textContent = activeRegions;
            document.getElementById('marketCenters').textContent = marketCentersCount;
        }

        // Ø¹Ø±Ø¶ ÙˆØ¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        function showLoading() {
            document.getElementById('loadingPanel').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loadingPanel').style.display = 'none';
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        document.getElementById('mapType').addEventListener('change', updateMapType);
        document.getElementById('displayOptions').addEventListener('change', () => {
            clearMarkers();
            updateMap();
        });
        
        document.getElementById('searchLocation').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchLocation();
            }
        });

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        function initializeMap() {
            drawDesertRoad();
            addMangoFarms();
            showMarkets();
            updateRegionsGrid();
            updateAnalysisData();
            
            // ØªØ¹Ø¯ÙŠÙ„ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ØªØ´Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹
            const bounds = L.latLngBounds(mangoRegions.map(region => [region.location.lat, region.location.lng]));
            map.fitBounds(bounds, { padding: [50, 50] });
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ù‚ÙŠØ§Ø³ Ø§Ù„Ù…Ø³Ø§ÙØ©
            L.control.scale({ 
                position: 'bottomleft', 
                metric: true, 
                imperial: false 
            }).addTo(map);
            
            updateStats();
        }

        // Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø®Ø±ÙŠØ·Ø©
        initializeMap();
        
        // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø© (Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©)
        setInterval(() => {
            console.log('ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù…Ø§Ù†Ø¬Ùˆ...');
            updateStats();
            
            // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø·ÙÙŠÙ Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­ÙŠØ©
            mangoRegions.forEach(region => {
                const variation = (Math.random() - 0.5) * 0.1;
                region.yield = Math.max(4.0, Math.min(6.5, region.yield + variation));
                region.production = Math.round(region.area * region.yield);
            });
            
            updateAnalysisData();
        }, 60000);

        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ø¹Ù†Ø§ØµØ±
        document.addEventListener('DOMContentLoaded', () => {
            // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± hover Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
            const cards = document.querySelectorAll('.stat-card, .region-card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-10px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', () => {
                    card.style.transform = 'translateY(0) scale(1)';
                });
            });
        });
    </script>

</body>
</html>
